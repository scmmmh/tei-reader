(function(t){function e(e){for(var s,r,o=e[0],c=e[1],l=e[2],h=0,p=[];h<o.length;h++)r=o[h],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&p.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(s=!1)}s&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},a={app:0},i=[];function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"5c0b":function(t,e,n){"use strict";var s=n("9c0c"),a=n.n(s);a.a},"9c0c":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"mode-"+this.$store.state.ui.mode,attrs:{id:"app"}},[n("TeiReader")],1)},i=[],r=n("d4ec"),o=n("bee2"),c=n("99de"),l=n("7e84"),u=n("262e"),h=n("9ab4"),p=n("60a3"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tei-reader"},[n("div",{class:this.$store.state.ui.smallMenuOpen?"small-menu-open":null},[t.isSmall&&t.isSmallMenuOpen?n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]):t._e(),!t.isSmall&&t.hasMultipleSections||t.isSmall&&t.isSmallMenuOpen?n("nav",[n("ul",{attrs:{role:"menubar"}},[t._l(t.sections,(function(e,s){return n("li",{key:s,attrs:{role:"presentation"}},[n("a",{attrs:{role:"menuitem","aria-checked":s===t.selectedSection?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(e){return t.selectSection(s)}}})])})),t.closeLabel&&t.closeCallback?n("li",{attrs:{role:"presentation"}},[n("a",{attrs:{role:"menuitem"},domProps:{innerHTML:t._s(t.closeLabel)},on:{click:t.close}})]):t._e()],2)]):t._e()]),t._l(t.sections,(function(e,s){return[s===t.selectedSection&&"Text"===e.type?n("text-reader",{key:s,attrs:{section:s}}):s===t.selectedSection&&"Metadata"===e.type?n("metadata-reader",{key:s,attrs:{section:s}}):s===t.selectedSection&&"NestedList"===e.type?n("nested-list-reader",{key:s,attrs:{section:s}}):t._e()]}))],2)},f=[],m=(n("b64b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"text-reader"},[t.isSmall&&t.headings.length>0?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),n("nav",{staticClass:"vertical"},[n("ul",[t._l(t.headings,(function(e,s){return[e.target===t.activeHeading||!t.activeHeading&&0===s||t.isSmallMenuOpen?n("li",{key:s},[n("a",{attrs:{"aria-checked":e.target===t.activeHeading?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(n){t.isSmallMenuOpen?t.navigateTo(e.target):t.toggleSmallMenu()}}})]):t._e()]}))],2)])]):t._e(),!t.isSmall&&t.headings.length>0?n("nav",{staticClass:"vertical"},[n("ul",t._l(t.headings,(function(e,s){return n("li",{key:s},[n("a",{attrs:{"aria-checked":e.target===t.activeHeading?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(n){return t.navigateTo(e.target)}}})])})),0)]):t._e(),n("article",[n("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.scrollReader,expression:"scrollReader"}],domProps:{innerHTML:t._s(t.text)},on:{click:t.textClick}}),t.footnote?n("aside",[n("a",{on:{click:function(e){return t.hideFootnote(t.footnote[0])}}},[t._v("✖")]),n("text-node",{attrs:{section:t.section,node:t.footnote[1]}})],1):t._e()]),!t.isSmall&&t.hasNestedDocs?n("aside",t._l(t.annotations,(function(e,s){var a=e[0],i=e[1];return n("section",{key:s},[n("a",{on:{click:function(e){return t.hideAnnotation(a)}}},[t._v("✖")]),i?n("text-node",{attrs:{section:t.section,node:i}}):t._e()],1)})),0):t._e()])}),v=[],g=(n("99af"),n("4160"),n("a15b"),n("d81d"),n("b0c0"),n("4fad"),n("159b"),n("3835")),b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isReference?n("a",t._b({class:"node-"+t.node.type,on:{click:t.toggleReference}},"a",t.nodeAttrs,!1),[t.node.text?n("span",[t._v(t._s(t.node.text))]):t._e(),t._l(t.node.content,(function(e,s){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:s,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:s,attrs:{section:t.section,node:e}})]}))],2):t.isInline?n("span",t._b({class:"node-"+t.node.type},"span",t.nodeAttrs,!1),[t.node.text?n("span",[t._v(t._s(t.node.text))]):t._e(),t._l(t.node.content,(function(e,s){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:s,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:s,attrs:{section:t.section,node:e}})]}))],2):n("div",t._b({class:"node-"+t.node.type},"div",t.nodeAttrs,!1),[t._l(t.node.content,(function(e,s){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:s,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:s,attrs:{section:t.section,node:e}})]}))],2)},y=[],k=function(t){function e(){return Object(r["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"marks",value:function(t){return t.marks?t.marks.map((function(t){return"mark-"+t.type})):[]}},{key:"markAttrs",value:function(t){if(t.marks){var e={};return t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var n=Object(g["a"])(t,2),s=n[0],a=n[1];a&&(e["data-"+s]=a)}))})),e}return{}}},{key:"toggleReference",value:function(){var t=this.typeDef;t&&this.isReference&&this.$props.node.attrs[t.reference.attr]&&(this.isSmall||"sidebar"!==t.reference.display?this.$store.commit("toggleFootnote",{path:this.$props.section+".nested."+t.reference.type+"."+this.$props.node.attrs[t.reference.attr].substring(1)}):this.$store.commit("toggleAnnotation",{path:this.$props.section+".nested."+t.reference.type+"."+this.$props.node.attrs[t.reference.attr].substring(1)}))}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"typeDef",get:function(){for(var t=this.$store.state.sections[this.$props.section].schema,e=0;e<t.length;e++)if(t[e].name===this.$props.node.type)return t[e];return null}},{key:"nodeAttrs",get:function(){var t={};return this.$props.node.attrs&&Object.entries(this.$props.node.attrs).forEach((function(e){var n=Object(g["a"])(e,2),s=n[0],a=n[1];a&&(t["data-"+s]=a)})),t}},{key:"isReference",get:function(){var t=this.typeDef;return!(!t||!t.reference)}},{key:"isInline",get:function(){var t=this.typeDef;return!(!t||"inline"!==t.type)}}]),e}(p["c"]);Object(h["a"])([Object(p["b"])()],k.prototype,"section",void 0),Object(h["a"])([Object(p["b"])()],k.prototype,"node",void 0),k=Object(h["a"])([Object(p["a"])({name:"text-node"})],k);var O=k,j=O,$=n("2877"),x=Object($["a"])(j,b,y,!1,null,null,null),S=x.exports;n("fb6a"),n("a9e3"),n("25eb"),n("ac1f"),n("1276");function _(t,e){var n=e.split(".");while(t&&n.length>0){if("["===n[0][0]&&"]"===n[0][n[0].length-1]){var s=Number.parseInt(n[0].substring(1,n[0].length-1));s>=0&&s<t.length&&(t=t[s])}else t=t[n[0]];n=n.slice(1)}return t}var M=n("4396"),T=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.activeHeading="",t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){this.docUpdated()}},{key:"hideAnnotation",value:function(t){this.$store.commit("toggleAnnotation",{path:t})}},{key:"hideFootnote",value:function(t){this.$store.commit("toggleFootnote",{path:t})}},{key:"navigateTo",value:function(t){var e=document.querySelector('[data-id="'+t+'"]');if(e){var n=this.$el.querySelector("article > div");n&&Object(M["a"])(n.scrollTop,e.offsetTop,(function(t){n.scrollTop=t}))}this.isSmallMenuOpen&&this.toggleSmallMenu()}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"scrollReader",value:function(t,e){if(this&&this.$el){var n=this.headings.map((function(t){return'[data-id="'+t.target+'"]'})).join(", ");if(""!==n){var s=window.localStorage.getItem("tei-reader"),a={};s&&(a=JSON.parse(s)),a[this.$store.state.ui.identifier]||(a[this.$store.state.ui.identifier]={}),a[this.$store.state.ui.identifier][this.$props.section]||(a[this.$store.state.ui.identifier][this.$props.section]=0),a[this.$store.state.ui.identifier][this.$props.section]=e.scrollTop,window.localStorage.setItem("tei-reader",JSON.stringify(a));var i=this.$el.querySelectorAll(n);if(i.length>0){if(this.activeHeading=null,e.scrollTop>0){var r=this.$el.querySelector("article");r&&(e.scrollTop=e.scrollTop+.25*r.clientHeight)}for(var o=0;o<i.length;o++){var c=i[o];if(o<i.length-1){var l=i[o+1];e.scrollTop>=c.offsetTop&&e.scrollTop<l.offsetTop&&(this.activeHeading=c.getAttribute("data-id"))}else e.scrollTop>=c.offsetTop&&(this.activeHeading=c.getAttribute("data-id"))}}}}}},{key:"textClick",value:function(t){var e=t.target;while(e){if("a"===e.localName)break;e=e.parentElement}e&&e.getAttribute("data-reference-path")&&("sidebar"===e.getAttribute("data-reference-mode")?"small"===this.$store.state.ui.mode?this.$store.commit("toggleFootnote",{path:e.getAttribute("data-reference-path")}):this.$store.commit("toggleAnnotation",{path:e.getAttribute("data-reference-path")}):"footnote"===e.getAttribute("data-reference-mode")&&this.$store.commit("toggleFootnote",{path:e.getAttribute("data-reference-path")}))}},{key:"docUpdated",value:function(){var t=this,e=this.$el.querySelector("article > div");if(e.scrollTop=0,window.localStorage&&this.$store.state.ui.identifier&&this.$props.section){var n=window.localStorage.getItem("tei-reader"),s={};n&&(s=JSON.parse(n)),s[this.$store.state.ui.identifier]||(s[this.$store.state.ui.identifier]={}),s[this.$store.state.ui.identifier][this.$props.section]||(s[this.$store.state.ui.identifier][this.$props.section]=0);var a=this.$el.querySelector("article > div");p["c"].nextTick((function(){a.scrollTop=s[t.$store.state.ui.identifier][t.$props.section]})),window.localStorage.setItem("tei-reader",JSON.stringify(s))}}},{key:"nodeSchema",value:function(t,e){for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null}},{key:"getText",value:function(t){var e=this;return"text"===t.type&&t.text?t.text:t.content?t.content.map((function(t){return e.getText(t)})).join(""):""}},{key:"generateHeadings",value:function(t,e,n){if(t){for(var s=0;s<e.length;s++)e[s].name===t.type&&e[s].navigation&&t.attrs&&t.attrs[e[s].navigation.attr]&&n.push({target:t.attrs[e[s].navigation.attr],label:this.getText(t)});if(t.content)for(var a=0;a<t.content.length;a++)this.generateHeadings(t.content[a],e,n)}}},{key:"generateHTML",value:function(t,e){var n=[];if(t){var s=this.nodeSchema(t.type,e);if(s){if("text"===s.name?t.marks&&(n.push('<span class="'),t.marks.forEach((function(t,e){e>0?n.push(" mark-"+t.type):n.push("mark-"+t.type)})),n.push('"'),t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')}))})),n.push(">")):s.reference?(n.push('<a class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')})),t.attrs&&s.reference&&s.reference.attr&&t.attrs[s.reference.attr]&&(n.push(' data-reference-path="'+this.$props.section+".nested."+s.reference.type+"."+t.attrs[s.reference.attr].substring(1)+'"'),n.push(' data-reference-mode="'+s.reference.display+'"')),n.push(">")):"inline"===s.type?(n.push('<span class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')})),n.push(">")):(n.push('<div class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')})),n.push(">")),t.text&&n.push(t.text),t.content)for(var a=0;a<t.content.length;a++){var i=this.generateHTML(t.content[a],e);n=n.concat(i)}"text"===s.name?t.marks&&n.push("</span>"):s.reference?n.push("</a>"):"inline"===s.type?n.push("</span>"):n.push("</div>")}else if("doc"===t.type&&t.content)for(var r=0;r<t.content.length;r++){var o=this.generateHTML(t.content[r],e);n=n.concat(o)}}return n}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"doc",get:function(){var t=this.$store.state.content[this.$props.section];return t&&t.doc?t.doc:null}},{key:"hasNestedDocs",get:function(){return!!(this.$store.state.content[this.$props.section].nested&&Object.keys(this.$store.state.content[this.$props.section].nested).length>0)}},{key:"annotations",get:function(){var t=this;return this.$store.state.ui.sections[this.$props.section].annotations.map((function(e){var n=_(t.$store.state.content,e);return n?[e,n.content[0]]:null}))}},{key:"footnote",get:function(){var t=this.$store.state.ui.sections[this.$props.section].footnote;if(t){var e=_(this.$store.state.content,t);if(e)return[t,e.content[0]]}return null}},{key:"headings",get:function(){if(this.doc){var t=this.$store.state.sections[this.$props.section].schema,e=[];return this.generateHeadings(this.doc,t,e),e}return[]}},{key:"schema",get:function(){return this.$store.state.sections[this.$props.section].schema}},{key:"text",get:function(){return this.generateHTML(this.doc,this.schema).join("")}}]),e}(p["c"]);Object(h["a"])([Object(p["b"])()],T.prototype,"section",void 0),Object(h["a"])([Object(p["d"])("doc")],T.prototype,"docUpdated",null),T=Object(h["a"])([Object(p["a"])({components:{TextNode:S}})],T);var w=T,E=w,N=Object($["a"])(E,m,v,!1,null,null,null),D=N.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"metadata-reader"},[t.isSmall&&!t.isSmallMenuOpen?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),n("nav",{staticClass:"vertical"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v(t._s(t.$store.state.sections[t.section].label))])])])])]):t._e(),t._l(t.metadataGroups,(function(e,s){return n("section",{key:s},[n("h2",[t._v(t._s(e.label))]),t._l(e.entries,(function(e,s){return n("metadata-field",{key:s,attrs:{section:t.section,config:e,parent:""}})}))],2)}))],2)},L=[],C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["single-text"==t.config.type?[n("span",{staticClass:"field"},[n("span",{staticClass:"label"},[t._v(t._s(t.config.label))]),n("span",{staticClass:"value"},[t._v(t._s(t.value))])])]:t._e(),"multi-row"==t.config.type?[n("ol",{staticClass:"multi-row"},t._l(t.value,(function(e,s){return n("li",{key:s},t._l(t.config.entries,(function(e,a){return n("metadata-field",{key:a,attrs:{section:t.section,config:e,parent:t.parent+t.config.path+".["+s+"]"}})})),1)})),0)]:t._e(),"multi-field"==t.config.type?[n("ol",{staticClass:"multi-field"},t._l(t.config.entries,(function(e,s){return n("li",{key:s},[n("metadata-field",{attrs:{section:t.section,config:e,parent:t.parent+t.config.path}})],1)})),0)]:t._e()],2)},H=[],A=function(t){function e(){return Object(r["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"value",get:function(){var t=_(this.$store.state.content[this.$props.section],this.$props.parent+this.$props.config.path);return t||""}}]),e}(p["c"]);Object(h["a"])([Object(p["b"])()],A.prototype,"config",void 0),Object(h["a"])([Object(p["b"])()],A.prototype,"section",void 0),Object(h["a"])([Object(p["b"])()],A.prototype,"parent",void 0),A=Object(h["a"])([Object(p["a"])({name:"metadata-field"})],A);var I=A,P=I,V=Object($["a"])(P,C,H,!1,null,null,null),J=V.exports,q=function(t){function e(){return Object(r["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"metadataGroups",get:function(){return this.$store.state.sections[this.$props.section].ui}}]),e}(p["c"]);Object(h["a"])([Object(p["b"])()],q.prototype,"section",void 0),q=Object(h["a"])([Object(p["a"])({components:{MetadataField:J}})],q);var F=q,U=F,z=Object($["a"])(U,R,L,!1,null,null,null),X=z.exports,W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"nested-list-reader"},[t.isSmall&&!t.isSmallMenuOpen?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),n("nav",{staticClass:"vertical"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v(t._s(t.$store.state.sections[t.section].label))])])])])]):t._e(),n("article",[n("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.scrollReader,expression:"scrollReader"}],domProps:{innerHTML:t._s(t.text)},on:{click:t.textClick}})])])},Y=[],B=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.activeHeading="",t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){this.docUpdated()}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"scrollReader",value:function(t,e){if(this&&this.$el){var n=window.localStorage.getItem("tei-reader"),s={};n&&(s=JSON.parse(n)),s[this.$store.state.ui.identifier]||(s[this.$store.state.ui.identifier]={}),s[this.$store.state.ui.identifier][this.$props.section]||(s[this.$store.state.ui.identifier][this.$props.section]=0),s[this.$store.state.ui.identifier][this.$props.section]=e.scrollTop,window.localStorage.setItem("tei-reader",JSON.stringify(s))}}},{key:"textClick",value:function(t){var e=t.target;while(e){if("a"===e.localName)break;e=e.parentElement}var n=e.getAttribute("data-reference-path");if(e&&n){var s=n.split(".");if(s.length>0&&s[0]===this.sectionData.source&&s[2]==this.sectionData.nodeName){var a=this.$el.querySelector("article > div"),i=this.$el.querySelector("#"+s[3]);a&&i&&Object(M["a"])(a.scrollTop,i.offsetTop,(function(t){a.scrollTop=t}))}}}},{key:"docUpdated",value:function(){var t=this,e=this.$el.querySelector("article > div");if(e.scrollTop=0,window.localStorage&&this.$store.state.ui.identifier&&this.$props.section){var n=window.localStorage.getItem("tei-reader"),s={};n&&(s=JSON.parse(n)),s[this.$store.state.ui.identifier]||(s[this.$store.state.ui.identifier]={}),s[this.$store.state.ui.identifier][this.$props.section]||(s[this.$store.state.ui.identifier][this.$props.section]=0);var a=this.$el.querySelector("article > div");p["c"].nextTick((function(){a.scrollTop=s[t.$store.state.ui.identifier][t.$props.section]})),window.localStorage.setItem("tei-reader",JSON.stringify(s))}}},{key:"nodeSchema",value:function(t,e){for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null}},{key:"getText",value:function(t){var e=this;return"text"===t.type&&t.text?t.text:t.content?t.content.map((function(t){return e.getText(t)})).join(""):""}},{key:"generateHTML",value:function(t,e){var n=[];if(t){var s=this.nodeSchema(t.type,e);if(s){if("text"===s.name?t.marks&&(n.push('<span class="'),t.marks.forEach((function(t,e){e>0?n.push(" mark-"+t.type):n.push("mark-"+t.type)})),n.push('"'),t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')}))})),n.push(">")):s.reference?(n.push('<a class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')})),t.attrs&&s.reference&&s.reference.attr&&t.attrs[s.reference.attr]&&(n.push(' data-reference-path="'+this.$props.section+".nested."+s.reference.type+"."+t.attrs[s.reference.attr].substring(1)+'"'),n.push(' data-reference-mode="'+s.reference.display+'"')),n.push(">")):"inline"===s.type?(n.push('<span class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')})),n.push(">")):(n.push('<div class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];n.push(" data-"+s+'="'+a+'"')})),n.push(">")),t.text&&n.push(t.text),t.content)for(var a=0;a<t.content.length;a++){var i=this.generateHTML(t.content[a],e);n=n.concat(i)}"text"===s.name?t.marks&&n.push("</span>"):s.reference?n.push("</a>"):"inline"===s.type?n.push("</span>"):n.push("</div>")}else if("doc"===t.type&&t.content)for(var r=0;r<t.content.length;r++){var o=this.generateHTML(t.content[r],e);n=n.concat(o)}}return n}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"sectionData",get:function(){return this.$store.state.sections[this.$props.section]}},{key:"docs",get:function(){var t=this.$store.state.content[this.sectionData.source];return t&&t.nested&&t.nested[this.sectionData.nodeName]?t.nested[this.sectionData.nodeName]:null}},{key:"schema",get:function(){return this.$store.state.sections[this.sectionData.source].schema}},{key:"text",get:function(){var t=this;if(this.docs){var e=["<ol>"];return Object.entries(this.docs).forEach((function(n){var s=Object(g["a"])(n,2),a=s[0],i=s[1];i.content&&i.content.length>0&&(e.push('<li id="'+a+'">'),e=e.concat(t.generateHTML(i.content[0],t.schema)),e.push("</li>"))})),e.push("</ol>"),e.join("")}return null}}]),e}(p["c"]);Object(h["a"])([Object(p["b"])()],B.prototype,"section",void 0),Object(h["a"])([Object(p["d"])("doc")],B.prototype,"docUpdated",null),B=Object(h["a"])([Object(p["a"])({components:{TextNode:S}})],B);var G=B,K=G,Q=Object($["a"])(K,W,Y,!1,null,null,null),Z=Q.exports,tt=function(t){function e(){return Object(r["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"selectSection",value:function(t){this.$store.commit("selectSection",t),this.isSmall&&this.$store.commit("toggleSmallMenu")}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"close",value:function(){this.isSmall&&this.$store.commit("toggleSmallMenu"),this.closeCallback()}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"hasMultipleSections",get:function(){return Object.keys(this.$store.state.sections).length>1}},{key:"sections",get:function(){return this.$store.state.sections}},{key:"selectedSection",get:function(){return this.$store.state.ui.selectedSection}},{key:"closeLabel",get:function(){return this.$store.state.ui.closeLabel}},{key:"closeCallback",get:function(){return this.$store.state.callbacks.close}}]),e}(p["c"]);tt=Object(h["a"])([Object(p["a"])({components:{TextReader:D,MetadataReader:X,NestedListReader:Z}})],tt);var et=tt,nt=et,st=Object($["a"])(nt,d,f,!1,null,null,null),at=st.exports,it=function(t){function e(){return Object(r["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){var t=this,e=document.getElementById("TEIReaderConfig");if(e){var n=JSON.parse(e.innerHTML);n&&this.$store.commit("init",n)}this.$store.state.callbacks&&this.$store.state.callbacks.autoLoad&&this.$store.state.callbacks.autoLoad((function(e){t.$store.dispatch("load",e)})),this.updateWindowSize(),window.addEventListener("resize",this.updateWindowSize)}},{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.updateWindowSize)}},{key:"updateWindowSize",value:function(){window.innerWidth<1024?this.$store.commit("setMode","small"):this.$store.commit("setMode","large")}}]),e}(p["c"]);it=Object(h["a"])([Object(p["a"])({components:{TeiReader:at}})],it);var rt=it,ot=rt,ct=(n("5c0b"),Object($["a"])(ot,a,i,!1,null,null,null)),lt=ct.exports,ut=(n("c975"),n("a434"),n("2f62"));function ht(t){return"tei"===t?"http://www.tei-c.org/ns/1.0":"xml"===t?"http://www.w3.org/XML/1998/namespace":"http://www.tei-c.org/ns/1.0"}var pt=function(){function t(e){Object(r["a"])(this,t),this.dom=e}return Object(o["a"])(t,[{key:"evaluate",value:function(t,e,n){return this.dom.evaluate(e,t,ht,n,null)}},{key:"firstNode",value:function(t,e){return this.evaluate(t,e,XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue}},{key:"nodeIterator",value:function(t,e){return this.evaluate(t,e,XPathResult.ORDERED_NODE_ITERATOR_TYPE)}},{key:"stringValue",value:function(t,e){return this.evaluate(t,e,XPathResult.STRING_TYPE).stringValue}},{key:"booleanValue",value:function(t,e){return this.evaluate(t,e,XPathResult.BOOLEAN_TYPE).booleanValue}},{key:"numberValue",value:function(t,e){return this.evaluate(t,e,XPathResult.NUMBER_TYPE).numberValue}}]),t}(),dt=function(){function t(e,n){Object(r["a"])(this,t),this.dom=e,this.xpath=new pt(this.dom),this.config=n}return Object(o["a"])(t,[{key:"get",value:function(){if(!this.data){var t=this.xpath.firstNode(this.dom.documentElement,"/tei:TEI/tei:teiHeader");this.data={};for(var e=0;e<this.config.schema.length;e++){var n=this.parseHeaderNode(t,this.config.schema[e]);n&&(this.data[this.config.schema[e].tag.substring(4)]=n)}}return this.data}},{key:"parseHeaderNode",value:function(t,e){var n=this.xpath.nodeIterator(t,e.tag),s=[],a=n.iterateNext();while(a){for(var i={_attrs:{},_text:0===a.children.length?this.xpath.stringValue(a,"text()"):null},r=0;r<a.attributes.length;r++)i._attrs[a.attributes[r].name]=a.attributes[r].value;if(e.children)for(var o=0;o<e.children.length;o++){var c=this.parseHeaderNode(a,e.children[o]);c&&(i[e.children[o].tag.substring(e.children[o].tag.indexOf(":")+1)]=c)}s.push(i),a=n.iterateNext()}return 0===s.length?null:e.multiple?s:s[0]}}]),t}(),ft=function(){function t(e,n){Object(r["a"])(this,t),this.doc=null,this.nestedDocs={},this.dom=e,this.xpath=new pt(this.dom),this.config=n}return Object(o["a"])(t,[{key:"get",value:function(){if(!this.doc&&(this.doc={type:"doc",content:[]},this.nestedDocs={},this.config.parser&&this.config.parser.selector)){var t=this.xpath.firstNode(this.dom.documentElement,this.config.parser.selector);if(t)for(var e=0;e<t.children.length;e++){var n=this.parseContentNode(t.children[e],this.config);n&&!n.nestedDoc&&this.doc.content?this.doc.content.push(n):n&&n.nestedDoc&&this.addNestedDoc(n)}}return[this.doc,this.nestedDocs]}},{key:"parseContentAttributes",value:function(t,e){var n=this,s={};return Object.entries(e).forEach((function(e){var a=Object(g["a"])(e,2),i=a[0],r=a[1],o=[];r.parser?o.push(r.parser):r.parsers&&(o=r.parsers);for(var c=0;c<o.length;c++){var l=o[c];if("boolean"===l.type)s[i]=n.xpath.booleanValue(t,l.selector);else if("number"===l.type)try{s[i]=n.xpath.numberValue(t,l.selector)}catch(h){console.log(h)}else if("static"===l.type)n.xpath.booleanValue(t,l.selector)&&(s[i]=l.value);else try{var u=n.xpath.stringValue(t,l.selector);u&&(s[i]=u)}catch(h){console.log(h)}}})),s}},{key:"parseContentMarks",value:function(t,e){var n=this,s=[];return e.forEach((function(e){if("mark"===e.type){var a=[];e.parser?a.push(e.parser):e.parsers&&(a=e.parsers);for(var i=0;i<a.length;i++)if(n.xpath.booleanValue(t,a[i].selector)){var r={type:e.name};e.attrs&&(r.attrs=n.parseContentAttributes(t,e.attrs)),s.push(r)}}})),s}},{key:"parseContentNode",value:function(t,e){for(var n=Object.entries(e.schema),s=0;s<n.length;s++){var a=n[s][1],i=[];a.parser?i.push(a.parser):a.parsers&&(i=i.concat(a.parsers));for(var r=0;r<i.length;r++){var o=i[r];if(null!==this.xpath.firstNode(t,"self::"+o.selector)){var c={type:a.name};if(a.attrs&&(c.attrs=this.parseContentAttributes(t,a.attrs)),"nested"===a.type&&(c.nestedDoc=!0),"inline"===a.type)if("text"===a.name){if(o.text&&(c.text=this.xpath.stringValue(t,o.text)),c.marks=this.parseContentMarks(t,e.schema),1===t.children.length){var l=this.parseContentNode(t.children[0],e);l&&l.text&&""!==l.text&&(c.text=l.text),l&&l.marks&&(c.marks=c.marks.concat(l.marks))}}else if(0===t.children.length)o.text&&this.xpath.stringValue(t,o.text)&&(c.content=[{type:"text",text:this.xpath.stringValue(t,o.text),marks:this.parseContentMarks(t,e.schema)}]);else{for(var u=[],h=0;h<t.children.length;h++){var p=this.parseContentNode(t.children[h],e);p&&u.push(p)}c.content=u}else{for(var d=[],f=0;f<t.children.length;f++){var m=this.parseContentNode(t.children[f],e);m&&!m.nestedDoc?d.push(m):m&&m.nestedDoc&&this.addNestedDoc(m)}c.content=d}return c}}}return null}},{key:"addNestedDoc",value:function(t){if(t.attrs&&t.attrs.id){this.nestedDocs[t.type]||(this.nestedDocs[t.type]={}),this.nestedDocs[t.type][t.attrs.id]=t;var e={type:"doc",content:t.content};t.content=[e]}}}]),t}(),mt=n("53ca");function vt(t){if(void 0!==t){if(null===t)return null;if(Array.isArray(t))return t.map((function(t){return vt(t)}));if("object"===Object(mt["a"])(t)){var e={};return Object.keys(t).forEach((function(n){e[n]=vt(t[n])})),e}return t}}s["a"].use(ut["a"]);var gt=new ut["a"].Store({state:{content:{},callbacks:{},sections:{},ui:{mode:"small",smallMenuOpen:!1,selectedSection:null,sections:{},closeLabel:null,identifier:""}},mutations:{init:function(t,e){t.sections=e.sections,Object.keys(e.sections).forEach((function(n,a){s["a"].set(t.content,n,{}),"Text"===e.sections[n].type&&(s["a"].set(t.content[n],"doc",null),s["a"].set(t.content[n],"nested",{})),s["a"].set(t.ui.sections,n,{}),"Text"===e.sections[n].type&&(s["a"].set(t.ui.sections[n],"annotations",[]),s["a"].set(t.ui.sections[n],"footnote",null)),0===a&&(t.ui.selectedSection=n)})),window.TEIReader&&window.TEIReader.callbacks&&(s["a"].set(t.callbacks,"autoLoad",window.TEIReader.callbacks.autoLoad),s["a"].set(t.callbacks,"close",window.TEIReader.callbacks.close)),e.ui&&e.ui.closeLabel&&(t.ui.closeLabel=e.ui.closeLabel)},setTextDoc:function(t,e){var n=e.path.split(".");2===n.length?s["a"].set(t.content[n[0]],n[1],e.doc):4===n.length&&s["a"].set(t.content[n[0]].nested[n[2]][n[3]],"content",[e.doc])},addNestedDoc:function(t,e){var n=e.path.split(".");4===n.length&&(t.content[n[0]].nested[n[2]]||s["a"].set(t.content[n[0]].nested,n[2],{}),s["a"].set(t.content[n[0]].nested[n[2]],n[3],{attrs:{id:n[3]},content:[e.doc],nestedDoc:!0,type:n[2]}))},setMetadata:function(t,e){s["a"].set(t.content,e.path,e.metadata)},selectSection:function(t,e){t.ui.selectedSection=e},toggleAnnotation:function(t,e){var n=e.path.split(".");if(4===n.length){var a=vt(t.ui.sections[n[0]].annotations);a.indexOf(e.path)>=0?a.splice(a.indexOf(e.path),1):a.push(e.path),s["a"].set(t.ui.sections[n[0]],"annotations",a)}},toggleFootnote:function(t,e){var n=e.path.split(".");4===n.length&&(t.ui.sections[n[0]].footnote===e.path?s["a"].set(t.ui.sections[n[0]],"footnote",null):s["a"].set(t.ui.sections[n[0]],"footnote",e.path))},toggleSmallMenu:function(t){t.ui.smallMenuOpen=!t.ui.smallMenuOpen},setMode:function(t,e){t.ui.mode=e},setDocIdentifier:function(t,e){t.ui.identifier=e}},actions:{load:function(t,e){var n=t.commit,a=t.state;n("setDocIdentifier",e.identifier);var i=new DOMParser,r=i.parseFromString(e.content,"application/xml");s["a"].set(a,"content",{}),Object.keys(a.sections).forEach((function(t){s["a"].set(a.content,t,{}),s["a"].set(a.content[t],"doc",null),s["a"].set(a.content[t],"nested",{})})),Object.entries(a.sections).forEach((function(t){var e=Object(g["a"])(t,2),s=e[0],a=e[1];if("Metadata"===a.type)n("setMetadata",{path:s,metadata:new dt(r,a).get()});else if("Text"===a.type){var i=new ft(r,a).get(),o=Object(g["a"])(i,2),c=o[0],l=o[1];n("setTextDoc",{path:s+".doc",doc:c}),Object.entries(l).forEach((function(t){var e=Object(g["a"])(t,2),a=e[0],i=e[1];Object.entries(i).forEach((function(t){var e=Object(g["a"])(t,2),i=e[0],r=e[1];r.content&&n("addNestedDoc",{path:s+".nested."+a+"."+i,doc:r.content[0]})}))}))}}))}},modules:{}}),bt=n("b9dd");s["a"].use(bt["a"],{debounce:50}),s["a"].config.productionTip=!1,new s["a"]({store:gt,render:function(t){return t(lt)}}).$mount("#app")}});
//# sourceMappingURL=app.js.map