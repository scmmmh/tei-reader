(function(t){function e(e){for(var a,o,r=e[0],c=e[1],l=e[2],h=0,d=[];h<r.length;h++)o=r[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(a=!1)}a&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},s={app:0},i=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"5c0b":function(t,e,n){"use strict";var a=n("9c0c"),s=n.n(a);s.a},"9c0c":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"mode-"+this.$store.state.ui.mode,attrs:{id:"app"}},[n("TeiReader")],1)},i=[],o=n("d4ec"),r=n("bee2"),c=n("99de"),l=n("7e84"),u=n("262e"),h=n("9ab4"),d=n("60a3"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tei-reader"},[n("div",{class:this.$store.state.ui.smallMenuOpen?"small-menu-open":null},[t.isSmall&&t.isSmallMenuOpen?n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]):t._e(),!t.isSmall&&t.hasMultipleSections||t.isSmall&&t.isSmallMenuOpen?n("nav",[n("ul",{attrs:{role:"menubar"}},[t._l(t.sections,(function(e,a){return n("li",{key:a,attrs:{role:"presentation"}},[n("a",{attrs:{role:"menuitem","aria-checked":a===t.selectedSection?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(e){return t.selectSection(a)}}})])})),t.closeLabel&&t.closeCallback?n("li",{attrs:{role:"presentation"}},[n("a",{attrs:{role:"menuitem"},domProps:{innerHTML:t._s(t.closeLabel)},on:{click:t.close}})]):t._e()],2)]):t._e()]),t._l(t.sections,(function(e,a){return[a===t.selectedSection&&"Text"===e.type?n("text-reader",{key:a,attrs:{section:a}}):t._e(),a===t.selectedSection&&"Metadata"===e.type?n("metadata-reader",{key:a,attrs:{section:a}}):t._e()]}))],2)},f=[],m=(n("b64b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"text-reader"},[t.isSmall&&t.headings.length>0?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),n("nav",{staticClass:"vertical"},[n("ul",[t._l(t.headings,(function(e,a){return[e.target===t.activeHeading||!t.activeHeading&&0===a||t.isSmallMenuOpen?n("li",{key:a},[n("a",{attrs:{"aria-checked":e.target===t.activeHeading?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(n){t.isSmallMenuOpen?t.navigateTo(e.target):t.toggleSmallMenu()}}})]):t._e()]}))],2)])]):t._e(),!t.isSmall&&t.headings.length>0?n("nav",{staticClass:"vertical"},[n("ul",t._l(t.headings,(function(e,a){return n("li",{key:a},[n("a",{attrs:{"aria-checked":e.target===t.activeHeading?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(n){return t.navigateTo(e.target)}}})])})),0)]):t._e(),n("article",[n("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.scrollReader,expression:"scrollReader"}],domProps:{innerHTML:t._s(t.text)},on:{click:t.textClick}}),t.footnote?n("aside",[n("a",{on:{click:function(e){return t.hideFootnote(t.footnote[0])}}},[t._v("✖")]),n("text-node",{attrs:{section:t.section,node:t.footnote[1]}})],1):t._e()]),!t.isSmall&&t.hasNestedDocs?n("aside",t._l(t.annotations,(function(e,a){var s=e[0],i=e[1];return n("section",{key:a},[n("a",{on:{click:function(e){return t.hideAnnotation(s)}}},[t._v("✖")]),i?n("text-node",{attrs:{section:t.section,node:i}}):t._e()],1)})),0):t._e()])}),g=[],v=(n("99af"),n("4160"),n("a15b"),n("d81d"),n("b0c0"),n("4fad"),n("159b"),n("3835")),b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isReference?n("a",t._b({class:"node-"+t.node.type,on:{click:t.toggleReference}},"a",t.nodeAttrs,!1),[t.node.text?n("span",[t._v(t._s(t.node.text))]):t._e(),t._l(t.node.content,(function(e,a){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:a,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:a,attrs:{section:t.section,node:e}})]}))],2):t.isInline?n("span",t._b({class:"node-"+t.node.type},"span",t.nodeAttrs,!1),[t.node.text?n("span",[t._v(t._s(t.node.text))]):t._e(),t._l(t.node.content,(function(e,a){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:a,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:a,attrs:{section:t.section,node:e}})]}))],2):n("div",t._b({class:"node-"+t.node.type},"div",t.nodeAttrs,!1),[t._l(t.node.content,(function(e,a){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:a,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:a,attrs:{section:t.section,node:e}})]}))],2)},y=[],k=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(r["a"])(e,[{key:"marks",value:function(t){return t.marks?t.marks.map((function(t){return"mark-"+t.type})):[]}},{key:"markAttrs",value:function(t){if(t.marks){var e={};return t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var n=Object(v["a"])(t,2),a=n[0],s=n[1];s&&(e["data-"+a]=s)}))})),e}return{}}},{key:"toggleReference",value:function(){var t=this.typeDef;t&&this.isReference&&this.$props.node.attrs[t.reference.attr]&&(this.isSmall||"sidebar"!==t.reference.display?this.$store.commit("toggleFootnote",{path:this.$props.section+".nested."+t.reference.type+"."+this.$props.node.attrs[t.reference.attr].substring(1)}):this.$store.commit("toggleAnnotation",{path:this.$props.section+".nested."+t.reference.type+"."+this.$props.node.attrs[t.reference.attr].substring(1)}))}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"typeDef",get:function(){for(var t=this.$store.state.sections[this.$props.section].schema,e=0;e<t.length;e++)if(t[e].name===this.$props.node.type)return t[e];return null}},{key:"nodeAttrs",get:function(){var t={};return this.$props.node.attrs&&Object.entries(this.$props.node.attrs).forEach((function(e){var n=Object(v["a"])(e,2),a=n[0],s=n[1];s&&(t["data-"+a]=s)})),t}},{key:"isReference",get:function(){var t=this.typeDef;return!(!t||!t.reference)}},{key:"isInline",get:function(){var t=this.typeDef;return!(!t||"inline"!==t.type)}}]),e}(d["c"]);Object(h["a"])([Object(d["b"])()],k.prototype,"section",void 0),Object(h["a"])([Object(d["b"])()],k.prototype,"node",void 0),k=Object(h["a"])([Object(d["a"])({name:"text-node"})],k);var O=k,j=O,$=n("2877"),_=Object($["a"])(j,b,y,!1,null,null,null),x=_.exports;n("fb6a"),n("a9e3"),n("25eb"),n("ac1f"),n("1276");function S(t,e){var n=e.split(".");while(t&&n.length>0){if("["===n[0][0]&&"]"===n[0][n[0].length-1]){var a=Number.parseInt(n[0].substring(1,n[0].length-1));a>=0&&a<t.length&&(t=t[a])}else t=t[n[0]];n=n.slice(1)}return t}var M=n("4396"),w=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.activeHeading="",t}return Object(u["a"])(e,t),Object(r["a"])(e,[{key:"mounted",value:function(){this.docUpdated()}},{key:"hideAnnotation",value:function(t){this.$store.commit("toggleAnnotation",{path:t})}},{key:"hideFootnote",value:function(t){this.$store.commit("toggleFootnote",{path:t})}},{key:"navigateTo",value:function(t){var e=document.querySelector('[data-id="'+t+'"]');if(e){var n=this.$el.querySelector("article > div");n&&Object(M["a"])(n.scrollTop,e.offsetTop,(function(t){n.scrollTop=t}))}this.isSmallMenuOpen&&this.toggleSmallMenu()}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"scrollReader",value:function(t,e){if(this&&this.$el){var n=this.headings.map((function(t){return'[data-id="'+t.target+'"]'})).join(", ");if(""!==n){var a=window.localStorage.getItem("tei-reader"),s={};a&&(s=JSON.parse(a)),s[this.$store.state.ui.identifier]||(s[this.$store.state.ui.identifier]={}),s[this.$store.state.ui.identifier][this.$props.section]||(s[this.$store.state.ui.identifier][this.$props.section]=0),s[this.$store.state.ui.identifier][this.$props.section]=e.scrollTop,window.localStorage.setItem("tei-reader",JSON.stringify(s));var i=this.$el.querySelectorAll(n);if(i.length>0){if(this.activeHeading=null,e.scrollTop>0){var o=this.$el.querySelector("article");o&&(e.scrollTop=e.scrollTop+.25*o.clientHeight)}for(var r=0;r<i.length;r++){var c=i[r];if(r<i.length-1){var l=i[r+1];e.scrollTop>=c.offsetTop&&e.scrollTop<l.offsetTop&&(this.activeHeading=c.getAttribute("data-id"))}else e.scrollTop>=c.offsetTop&&(this.activeHeading=c.getAttribute("data-id"))}}}}}},{key:"textClick",value:function(t){var e=t.target;while(e){if("a"===e.localName)break;e=e.parentElement}e&&e.getAttribute("data-reference-path")&&("sidebar"===e.getAttribute("data-reference-mode")?"small"===this.$store.state.ui.mode?this.$store.commit("toggleFootnote",{path:e.getAttribute("data-reference-path")}):this.$store.commit("toggleAnnotation",{path:e.getAttribute("data-reference-path")}):"footnote"===e.getAttribute("data-reference-mode")&&this.$store.commit("toggleFootnote",{path:e.getAttribute("data-reference-path")}))}},{key:"docUpdated",value:function(){var t=this,e=this.$el.querySelector("article > div");if(e.scrollTop=0,window.localStorage&&this.$store.state.ui.identifier&&this.$props.section){var n=window.localStorage.getItem("tei-reader"),a={};n&&(a=JSON.parse(n)),a[this.$store.state.ui.identifier]||(a[this.$store.state.ui.identifier]={}),a[this.$store.state.ui.identifier][this.$props.section]||(a[this.$store.state.ui.identifier][this.$props.section]=0);var s=this.$el.querySelector("article > div");d["c"].nextTick((function(){s.scrollTop=a[t.$store.state.ui.identifier][t.$props.section]})),window.localStorage.setItem("tei-reader",JSON.stringify(a))}}},{key:"nodeSchema",value:function(t,e){for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null}},{key:"getText",value:function(t){var e=this;return"text"===t.type&&t.text?t.text:t.content?t.content.map((function(t){return e.getText(t)})).join(""):""}},{key:"generateHeadings",value:function(t,e,n){if(t){for(var a=0;a<e.length;a++)e[a].name===t.type&&e[a].navigation&&t.attrs&&t.attrs[e[a].navigation.attr]&&n.push({target:t.attrs[e[a].navigation.attr],label:this.getText(t)});if(t.content)for(var s=0;s<t.content.length;s++)this.generateHeadings(t.content[s],e,n)}}},{key:"generateHTML",value:function(t,e){var n=[];if(t){var a=this.nodeSchema(t.type,e);if(a){if("text"===a.name?t.marks&&(n.push('<span class="'),t.marks.forEach((function(t,e){e>0?n.push(" mark-"+t.type):n.push("mark-"+t.type)})),n.push('"'),t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(v["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')}))})),n.push(">")):a.reference?(n.push('<a class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(v["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),t.attrs&&a.reference&&a.reference.attr&&t.attrs[a.reference.attr]&&(n.push(' data-reference-path="'+this.$props.section+".nested."+a.reference.type+"."+t.attrs[a.reference.attr].substring(1)+'"'),n.push(' data-reference-mode="'+a.reference.display+'"')),n.push(">")):"inline"===a.type?(n.push('<span class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(v["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),n.push(">")):(n.push('<div class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(v["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),n.push(">")),t.text&&n.push(t.text),t.content)for(var s=0;s<t.content.length;s++){var i=this.generateHTML(t.content[s],e);n=n.concat(i)}"text"===a.name?t.marks&&n.push("</span>"):a.reference?n.push("</a>"):"inline"===a.type?n.push("</span>"):n.push("</div>")}else if("doc"===t.type&&t.content)for(var o=0;o<t.content.length;o++){var r=this.generateHTML(t.content[o],e);n=n.concat(r)}}return n}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"doc",get:function(){var t=this.$store.state.content[this.$props.section];return t&&t.doc?t.doc:null}},{key:"hasNestedDocs",get:function(){return!!(this.$store.state.content[this.$props.section].nested&&Object.keys(this.$store.state.content[this.$props.section].nested).length>0)}},{key:"annotations",get:function(){var t=this;return this.$store.state.ui.sections[this.$props.section].annotations.map((function(e){var n=S(t.$store.state.content,e);return n?[e,n.content[0]]:null}))}},{key:"footnote",get:function(){var t=this.$store.state.ui.sections[this.$props.section].footnote;if(t){var e=S(this.$store.state.content,t);if(e)return[t,e.content[0]]}return null}},{key:"headings",get:function(){if(this.doc){var t=this.$store.state.sections[this.$props.section].schema,e=[];return this.generateHeadings(this.doc,t,e),e}return[]}},{key:"schema",get:function(){return this.$store.state.sections[this.$props.section].schema}},{key:"text",get:function(){return this.generateHTML(this.doc,this.schema).join("")}}]),e}(d["c"]);Object(h["a"])([Object(d["b"])()],w.prototype,"section",void 0),Object(h["a"])([Object(d["d"])("doc")],w.prototype,"docUpdated",null),w=Object(h["a"])([Object(d["a"])({components:{TextNode:x}})],w);var T=w,E=T,N=Object($["a"])(E,m,g,!1,null,null,null),D=N.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"metadata-reader"},[t.isSmall?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),n("nav",{staticClass:"vertical"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v(t._s(t.$store.state.sections[t.section].label))])])])])]):t._e(),t._l(t.metadataGroups,(function(e,a){return n("section",{key:a},[n("h2",[t._v(t._s(e.label))]),t._l(e.entries,(function(e,a){return n("metadata-field",{key:a,attrs:{section:t.section,config:e,parent:""}})}))],2)}))],2)},A=[],C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["single-text"==t.config.type?[n("span",{staticClass:"field"},[n("span",{staticClass:"label"},[t._v(t._s(t.config.label))]),n("span",{staticClass:"value"},[t._v(t._s(t.value))])])]:t._e(),"multi-row"==t.config.type?[n("ol",{staticClass:"multi-row"},t._l(t.value,(function(e,a){return n("li",{key:a},t._l(t.config.entries,(function(e,s){return n("metadata-field",{key:s,attrs:{section:t.section,config:e,parent:t.parent+t.config.path+".["+a+"]"}})})),1)})),0)]:t._e(),"multi-field"==t.config.type?[n("ol",{staticClass:"multi-field"},t._l(t.config.entries,(function(e,a){return n("li",{key:a},[n("metadata-field",{attrs:{section:t.section,config:e,parent:t.parent+t.config.path}})],1)})),0)]:t._e()],2)},H=[],L=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(r["a"])(e,[{key:"value",get:function(){var t=S(this.$store.state.content[this.$props.section],this.$props.parent+this.$props.config.path);return t||""}}]),e}(d["c"]);Object(h["a"])([Object(d["b"])()],L.prototype,"config",void 0),Object(h["a"])([Object(d["b"])()],L.prototype,"section",void 0),Object(h["a"])([Object(d["b"])()],L.prototype,"parent",void 0),L=Object(h["a"])([Object(d["a"])({name:"metadata-field"})],L);var P=L,I=P,V=Object($["a"])(I,C,H,!1,null,null,null),F=V.exports,J=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(r["a"])(e,[{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"metadataGroups",get:function(){return this.$store.state.sections[this.$props.section].ui}}]),e}(d["c"]);Object(h["a"])([Object(d["b"])()],J.prototype,"section",void 0),J=Object(h["a"])([Object(d["a"])({components:{MetadataField:F}})],J);var q=J,z=q,X=Object($["a"])(z,R,A,!1,null,null,null),W=X.exports,Y=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(r["a"])(e,[{key:"selectSection",value:function(t){this.$store.commit("selectSection",t),this.isSmall&&this.$store.commit("toggleSmallMenu")}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"close",value:function(){this.isSmall&&this.$store.commit("toggleSmallMenu"),this.closeCallback()}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"hasMultipleSections",get:function(){return Object.keys(this.$store.state.sections).length>1}},{key:"sections",get:function(){return this.$store.state.sections}},{key:"selectedSection",get:function(){return this.$store.state.ui.selectedSection}},{key:"closeLabel",get:function(){return this.$store.state.ui.closeLabel}},{key:"closeCallback",get:function(){return this.$store.state.callbacks.close}}]),e}(d["c"]);Y=Object(h["a"])([Object(d["a"])({components:{TextReader:D,MetadataReader:W}})],Y);var U=Y,B=U,G=Object($["a"])(B,p,f,!1,null,null,null),K=G.exports,Q=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(r["a"])(e,[{key:"mounted",value:function(){var t=this,e=document.getElementById("TEIReaderConfig");if(e){var n=JSON.parse(e.innerHTML);n&&this.$store.commit("init",n)}this.$store.state.callbacks&&this.$store.state.callbacks.autoLoad&&this.$store.state.callbacks.autoLoad((function(e){t.$store.dispatch("load",e)})),this.updateWindowSize(),window.addEventListener("resize",this.updateWindowSize)}},{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.updateWindowSize)}},{key:"updateWindowSize",value:function(){window.innerWidth<1024?this.$store.commit("setMode","small"):this.$store.commit("setMode","large")}}]),e}(d["c"]);Q=Object(h["a"])([Object(d["a"])({components:{TeiReader:K}})],Q);var Z=Q,tt=Z,et=(n("5c0b"),Object($["a"])(tt,s,i,!1,null,null,null)),nt=et.exports,at=(n("c975"),n("a434"),n("2f62"));function st(t){return"tei"===t?"http://www.tei-c.org/ns/1.0":"xml"===t?"http://www.w3.org/XML/1998/namespace":"http://www.tei-c.org/ns/1.0"}var it=function(){function t(e){Object(o["a"])(this,t),this.dom=e}return Object(r["a"])(t,[{key:"evaluate",value:function(t,e,n){return this.dom.evaluate(e,t,st,n,null)}},{key:"firstNode",value:function(t,e){return this.evaluate(t,e,XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue}},{key:"nodeIterator",value:function(t,e){return this.evaluate(t,e,XPathResult.ORDERED_NODE_ITERATOR_TYPE)}},{key:"stringValue",value:function(t,e){return this.evaluate(t,e,XPathResult.STRING_TYPE).stringValue}},{key:"booleanValue",value:function(t,e){return this.evaluate(t,e,XPathResult.BOOLEAN_TYPE).booleanValue}},{key:"numberValue",value:function(t,e){return this.evaluate(t,e,XPathResult.NUMBER_TYPE).numberValue}}]),t}(),ot=function(){function t(e,n){Object(o["a"])(this,t),this.dom=e,this.xpath=new it(this.dom),this.config=n}return Object(r["a"])(t,[{key:"get",value:function(){if(!this.data){var t=this.xpath.firstNode(this.dom.documentElement,"/tei:TEI/tei:teiHeader");this.data={};for(var e=0;e<this.config.schema.length;e++){var n=this.parseHeaderNode(t,this.config.schema[e]);n&&(this.data[this.config.schema[e].tag.substring(4)]=n)}}return this.data}},{key:"parseHeaderNode",value:function(t,e){var n=this.xpath.nodeIterator(t,e.tag),a=[],s=n.iterateNext();while(s){for(var i={_attrs:{},_text:0===s.children.length?this.xpath.stringValue(s,"text()"):null},o=0;o<s.attributes.length;o++)i._attrs[s.attributes[o].name]=s.attributes[o].value;if(e.children)for(var r=0;r<e.children.length;r++){var c=this.parseHeaderNode(s,e.children[r]);c&&(i[e.children[r].tag.substring(e.children[r].tag.indexOf(":")+1)]=c)}a.push(i),s=n.iterateNext()}return 0===a.length?null:e.multiple?a:a[0]}}]),t}(),rt=function(){function t(e,n){Object(o["a"])(this,t),this.doc=null,this.nestedDocs={},this.dom=e,this.xpath=new it(this.dom),this.config=n}return Object(r["a"])(t,[{key:"get",value:function(){if(!this.doc&&(this.doc={type:"doc",content:[]},this.nestedDocs={},this.config.parser&&this.config.parser.selector)){var t=this.xpath.firstNode(this.dom.documentElement,this.config.parser.selector);if(t)for(var e=0;e<t.children.length;e++){var n=this.parseContentNode(t.children[e],this.config);n&&!n.nestedDoc&&this.doc.content?this.doc.content.push(n):n&&n.nestedDoc&&this.addNestedDoc(n)}}return[this.doc,this.nestedDocs]}},{key:"parseContentAttributes",value:function(t,e){var n=this,a={};return Object.entries(e).forEach((function(e){var s=Object(v["a"])(e,2),i=s[0],o=s[1],r=[];o.parser?r.push(o.parser):o.parsers&&(r=o.parsers);for(var c=0;c<r.length;c++){var l=r[c];if("boolean"===l.type)a[i]=n.xpath.booleanValue(t,l.selector);else if("number"===l.type)try{a[i]=n.xpath.numberValue(t,l.selector)}catch(h){console.log(h)}else if("static"===l.type)n.xpath.booleanValue(t,l.selector)&&(a[i]=l.value);else try{var u=n.xpath.stringValue(t,l.selector);u&&(a[i]=u)}catch(h){console.log(h)}}})),a}},{key:"parseContentMarks",value:function(t,e){var n=this,a=[];return e.forEach((function(e){if("mark"===e.type){var s=[];e.parser?s.push(e.parser):e.parsers&&(s=e.parsers);for(var i=0;i<s.length;i++)if(n.xpath.booleanValue(t,s[i].selector)){var o={type:e.name};e.attrs&&(o.attrs=n.parseContentAttributes(t,e.attrs)),a.push(o)}}})),a}},{key:"parseContentNode",value:function(t,e){for(var n=Object.entries(e.schema),a=0;a<n.length;a++){var s=n[a][1],i=[];s.parser?i.push(s.parser):s.parsers&&(i=i.concat(s.parsers));for(var o=0;o<i.length;o++){var r=i[o];if(null!==this.xpath.firstNode(t,"self::"+r.selector)){var c={type:s.name};if(s.attrs&&(c.attrs=this.parseContentAttributes(t,s.attrs)),"nested"===s.type&&(c.nestedDoc=!0),"inline"===s.type)if("text"===s.name){if(r.text&&(c.text=this.xpath.stringValue(t,r.text)),c.marks=this.parseContentMarks(t,e.schema),1===t.children.length){var l=this.parseContentNode(t.children[0],e);l&&l.text&&""!==l.text&&(c.text=l.text),l&&l.marks&&(c.marks=c.marks.concat(l.marks))}}else if(0===t.children.length)r.text&&this.xpath.stringValue(t,r.text)&&(c.content=[{type:"text",text:this.xpath.stringValue(t,r.text),marks:this.parseContentMarks(t,e.schema)}]);else{for(var u=[],h=0;h<t.children.length;h++){var d=this.parseContentNode(t.children[h],e);d&&u.push(d)}c.content=u}else{for(var p=[],f=0;f<t.children.length;f++){var m=this.parseContentNode(t.children[f],e);m&&!m.nestedDoc?p.push(m):m&&m.nestedDoc&&this.addNestedDoc(m)}c.content=p}return c}}}return null}},{key:"addNestedDoc",value:function(t){if(t.attrs&&t.attrs.id){this.nestedDocs[t.type]||(this.nestedDocs[t.type]={}),this.nestedDocs[t.type][t.attrs.id]=t;var e={type:"doc",content:t.content};t.content=[e]}}}]),t}(),ct=n("53ca");function lt(t){if(void 0!==t){if(null===t)return null;if(Array.isArray(t))return t.map((function(t){return lt(t)}));if("object"===Object(ct["a"])(t)){var e={};return Object.keys(t).forEach((function(n){e[n]=lt(t[n])})),e}return t}}a["a"].use(at["a"]);var ut=new at["a"].Store({state:{content:{},callbacks:{},sections:{},ui:{mode:"small",smallMenuOpen:!1,selectedSection:null,sections:{},closeLabel:null,identifier:""}},mutations:{init:function(t,e){t.sections=e.sections,Object.keys(e.sections).forEach((function(n,s){a["a"].set(t.content,n,{}),"Text"===e.sections[n].type&&(a["a"].set(t.content[n],"doc",null),a["a"].set(t.content[n],"nested",{})),a["a"].set(t.ui.sections,n,{}),"Text"===e.sections[n].type&&(a["a"].set(t.ui.sections[n],"annotations",[]),a["a"].set(t.ui.sections[n],"footnote",null)),0===s&&(t.ui.selectedSection=n)})),window.TEIReader&&window.TEIReader.callbacks&&(a["a"].set(t.callbacks,"autoLoad",window.TEIReader.callbacks.autoLoad),a["a"].set(t.callbacks,"close",window.TEIReader.callbacks.close)),e.ui&&e.ui.closeLabel&&(t.ui.closeLabel=e.ui.closeLabel)},setTextDoc:function(t,e){var n=e.path.split(".");2===n.length?a["a"].set(t.content[n[0]],n[1],e.doc):4===n.length&&a["a"].set(t.content[n[0]].nested[n[2]][n[3]],"content",[e.doc])},addNestedDoc:function(t,e){var n=e.path.split(".");4===n.length&&(t.content[n[0]].nested[n[2]]||a["a"].set(t.content[n[0]].nested,n[2],{}),a["a"].set(t.content[n[0]].nested[n[2]],n[3],{attrs:{id:n[3]},content:[e.doc],nestedDoc:!0,type:n[2]}))},setMetadata:function(t,e){a["a"].set(t.content,e.path,e.metadata)},selectSection:function(t,e){t.ui.selectedSection=e},toggleAnnotation:function(t,e){var n=e.path.split(".");if(4===n.length){var s=lt(t.ui.sections[n[0]].annotations);s.indexOf(e.path)>=0?s.splice(s.indexOf(e.path),1):s.push(e.path),a["a"].set(t.ui.sections[n[0]],"annotations",s)}},toggleFootnote:function(t,e){var n=e.path.split(".");4===n.length&&(t.ui.sections[n[0]].footnote===e.path?a["a"].set(t.ui.sections[n[0]],"footnote",null):a["a"].set(t.ui.sections[n[0]],"footnote",e.path))},toggleSmallMenu:function(t){t.ui.smallMenuOpen=!t.ui.smallMenuOpen},setMode:function(t,e){t.ui.mode=e},setDocIdentifier:function(t,e){t.ui.identifier=e}},actions:{load:function(t,e){var n=t.commit,s=t.state;n("setDocIdentifier",e.identifier);var i=new DOMParser,o=i.parseFromString(e.content,"application/xml");a["a"].set(s,"content",{}),Object.keys(s.sections).forEach((function(t){a["a"].set(s.content,t,{}),a["a"].set(s.content[t],"doc",null),a["a"].set(s.content[t],"nested",{})})),Object.entries(s.sections).forEach((function(t){var e=Object(v["a"])(t,2),a=e[0],s=e[1];if("Metadata"===s.type)n("setMetadata",{path:a,metadata:new ot(o,s).get()});else if("Text"===s.type){var i=new rt(o,s).get(),r=Object(v["a"])(i,2),c=r[0],l=r[1];n("setTextDoc",{path:a+".doc",doc:c}),Object.entries(l).forEach((function(t){var e=Object(v["a"])(t,2),s=e[0],i=e[1];Object.entries(i).forEach((function(t){var e=Object(v["a"])(t,2),i=e[0],o=e[1];o.content&&n("addNestedDoc",{path:a+".nested."+s+"."+i,doc:o.content[0]})}))}))}}))}},modules:{}}),ht=n("b9dd");a["a"].use(ht["a"],{debounce:50}),a["a"].config.productionTip=!1,new a["a"]({store:ut,render:function(t){return t(nt)}}).$mount("#app")}});
//# sourceMappingURL=app.js.map