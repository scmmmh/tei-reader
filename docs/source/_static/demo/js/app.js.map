{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?c650","webpack:///./src/App.vue?caa5","webpack:///./src/components/TeiReader.vue?3db8","webpack:///./src/components/TextReader.vue?e4d7","webpack:///./src/components/TextNode.vue?b741","webpack:///./src/components/TextNode.vue","webpack:///./src/components/TextNode.vue?0179","webpack:///./src/components/TextNode.vue?cf73","webpack:///./src/util/get.ts","webpack:///./src/components/TextReader.vue","webpack:///./src/components/TextReader.vue?d595","webpack:///./src/components/TextReader.vue?d3a1","webpack:///./src/components/MetadataReader.vue?ac95","webpack:///./src/components/MetadataField.vue?b3c5","webpack:///./src/components/MetadataField.vue","webpack:///./src/components/MetadataField.vue?1d8a","webpack:///./src/components/MetadataField.vue?8461","webpack:///./src/components/MetadataReader.vue","webpack:///./src/components/MetadataReader.vue?6b27","webpack:///./src/components/MetadataReader.vue?d550","webpack:///./src/components/NestedListReader.vue?8838","webpack:///./src/components/NestedListReader.vue","webpack:///./src/components/NestedListReader.vue?9711","webpack:///./src/components/NestedListReader.vue?b449","webpack:///./src/components/TeiReader.vue","webpack:///./src/components/TeiReader.vue?4a5d","webpack:///./src/components/TeiReader.vue?7e96","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/util/XPathEvaluator.ts","webpack:///./src/util/TEIMetadataParser.ts","webpack:///./src/util/TEITextParser.ts","webpack:///./src/util/deepclone.ts","webpack:///./src/store/index.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","class","$store","state","ui","attrs","staticRenderFns","staticClass","smallMenuOpen","isSmall","isSmallMenuOpen","on","toggleSmallMenu","_v","_e","hasMultipleSections","_l","selectedSection","domProps","_s","label","$event","selectSection","closeLabel","closeCallback","close","type","headings","heading","idx","target","activeHeading","navigateTo","directives","rawName","expression","text","textClick","hideFootnote","footnote","section","hasNestedDocs","ref","annotationId","annotation","hideAnnotation","_b","node","toggleReference","nodeAttrs","child","marks","markAttrs","map","mark","forEach","entries","typeDef","isReference","$props","reference","attr","display","commit","path","substring","schema","sections","component","obj","pathElements","split","Number","parseInt","docUpdated","element","document","querySelector","container","$el","scrollTop","offsetTop","ev","scroll","headingsSelector","join","teiReaderSrc","localStorage","getItem","teiReader","JSON","parse","identifier","setItem","stringify","querySelectorAll","article","clientHeight","nextHeading","getAttribute","localName","parentElement","nextTick","content","getText","navigation","generateHeadings","textElements","nodeSchema","tmpElements","generateHTML","concat","sectionData","doc","nested","keys","annotations","annotationDoc","footnoteDoc","components","TextNode","group","entry","idx2","config","parent","MetadataField","referencePath","source","nodeName","docs","lines","id","callbacks","TextReader","MetadataReader","NestedListReader","configElement","getElementById","innerHTML","autoLoad","sourceData","dispatch","updateWindowSize","addEventListener","removeEventListener","innerWidth","TeiReader","nsResolver","prefix","dom","xpath","resultType","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","ORDERED_NODE_ITERATOR_TYPE","STRING_TYPE","stringValue","BOOLEAN_TYPE","booleanValue","NUMBER_TYPE","numberValue","header","firstNode","documentElement","temp","parseHeaderNode","tag","elements","nodeIterator","iterateNext","_attrs","_text","children","attributes","indexOf","multiple","nestedDocs","parser","selector","tmp","parseContentNode","nestedDoc","addNestedDoc","parsers","e","console","log","parseContentAttributes","parseContentMarks","idx3","nestedParent","deepclone","undefined","Array","isArray","val","clone","use","Store","mutations","init","set","TEIReader","setTextDoc","payload","setMetadata","metadata","toggleAnnotation","toggleFootnote","setMode","setDocIdentifier","actions","load","newDoc","domParser","DOMParser","parseFromString","nestedKey","docKey","debounce","productionTip","store","render","h","$mount"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,IAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,kBAEjBM,K,6ECvJT,yBAAmf,EAAG,G,0HCAlf,EAAS,WAAa,IAAIyC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,QAAUL,KAAKM,OAAOC,MAAMC,GAAGvB,KAAKwB,MAAM,CAAC,GAAK,QAAQ,CAACN,EAAG,cAAc,IACtLO,EAAkB,G,oFCDlB,EAAS,WAAa,IAAIX,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACQ,YAAY,cAAc,CAACR,EAAG,MAAM,CAACE,MAAML,KAAKM,OAAOC,MAAMC,GAAGI,cAAgB,kBAAoB,MAAM,CAAEb,EAAIc,SAAWd,EAAIe,gBAAiBX,EAAG,MAAM,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACA,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQhB,EAAIiB,kBAAkB,CAACjB,EAAIkB,GAAG,aAAalB,EAAImB,MAAQnB,EAAIc,SAAWd,EAAIoB,qBAAyBpB,EAAIc,SAAWd,EAAIe,gBAAkBX,EAAG,MAAM,CAACA,EAAG,KAAK,CAACM,MAAM,CAAC,KAAO,YAAY,CAACV,EAAIqB,GAAIrB,EAAY,UAAE,SAAShB,EAAMM,GAAK,OAAOc,EAAG,KAAK,CAACd,IAAIA,EAAIoB,MAAM,CAAC,KAAO,iBAAiB,CAACN,EAAG,IAAI,CAACM,MAAM,CAAC,KAAO,WAAW,eAAepB,IAAQU,EAAIsB,gBAAkB,OAAS,SAASC,SAAS,CAAC,UAAYvB,EAAIwB,GAAGxC,EAAMyC,QAAQT,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAO1B,EAAI2B,cAAcrC,YAAcU,EAAI4B,YAAc5B,EAAI6B,cAAezB,EAAG,KAAK,CAACM,MAAM,CAAC,KAAO,iBAAiB,CAACN,EAAG,IAAI,CAACM,MAAM,CAAC,KAAO,YAAYa,SAAS,CAAC,UAAYvB,EAAIwB,GAAGxB,EAAI4B,aAAaZ,GAAG,CAAC,MAAQhB,EAAI8B,WAAW9B,EAAImB,MAAM,KAAKnB,EAAImB,OAAOnB,EAAIqB,GAAIrB,EAAY,UAAE,SAAShB,EAAMM,GAAK,MAAO,CAAEA,IAAQU,EAAIsB,iBAAkC,SAAftC,EAAM+C,KAAiB3B,EAAG,cAAc,CAACd,IAAIA,EAAIoB,MAAM,CAAC,QAAUpB,KAAQA,IAAQU,EAAIsB,iBAAkC,aAAftC,EAAM+C,KAAqB3B,EAAG,kBAAkB,CAACd,IAAIA,EAAIoB,MAAM,CAAC,QAAUpB,KAAQA,IAAQU,EAAIsB,iBAAkC,eAAftC,EAAM+C,KAAuB3B,EAAG,qBAAqB,CAACd,IAAIA,EAAIoB,MAAM,CAAC,QAAUpB,KAAOU,EAAImB,UAAS,IAC/2C,EAAkB,GCDlB,G,UAAS,WAAa,IAAInB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAAO,CAACQ,YAAY,eAAe,CAAEZ,EAAIc,SAAWd,EAAIgC,SAASrF,OAAS,EAAGyD,EAAG,MAAM,CAACE,MAAMN,EAAIe,gBAAkB,kBAAoB,MAAM,CAACX,EAAG,MAAM,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACA,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQhB,EAAIiB,kBAAkB,CAACjB,EAAIkB,GAAG,aAAad,EAAG,MAAM,CAACQ,YAAY,YAAY,CAACR,EAAG,KAAK,CAACJ,EAAIqB,GAAIrB,EAAY,UAAE,SAASiC,EAAQC,GAAK,MAAO,CAAED,EAAQE,SAAWnC,EAAIoC,gBAAmBpC,EAAIoC,eAAyB,IAARF,GAAclC,EAAIe,gBAAiBX,EAAG,KAAK,CAACd,IAAI4C,GAAK,CAAC9B,EAAG,IAAI,CAACM,MAAM,CAAC,eAAeuB,EAAQE,SAAWnC,EAAIoC,cAAgB,OAAS,SAASb,SAAS,CAAC,UAAYvB,EAAIwB,GAAGS,EAAQR,QAAQT,GAAG,CAAC,MAAQ,SAASU,GAAQ1B,EAAIe,gBAAkBf,EAAIqC,WAAWJ,EAAQE,QAAUnC,EAAIiB,wBAAwBjB,EAAImB,UAAS,OAAOnB,EAAImB,MAAOnB,EAAIc,SAAWd,EAAIgC,SAASrF,OAAS,EAAGyD,EAAG,MAAM,CAACQ,YAAY,YAAY,CAACR,EAAG,KAAKJ,EAAIqB,GAAIrB,EAAY,UAAE,SAASiC,EAAQC,GAAK,OAAO9B,EAAG,KAAK,CAACd,IAAI4C,GAAK,CAAC9B,EAAG,IAAI,CAACM,MAAM,CAAC,eAAeuB,EAAQE,SAAWnC,EAAIoC,cAAgB,OAAS,SAASb,SAAS,CAAC,UAAYvB,EAAIwB,GAAGS,EAAQR,QAAQT,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAO1B,EAAIqC,WAAWJ,EAAQE,iBAAgB,KAAKnC,EAAImB,KAAKf,EAAG,UAAU,CAACA,EAAG,MAAM,CAACkC,WAAW,CAAC,CAAC/D,KAAK,SAASgE,QAAQ,WAAWvD,MAAOgB,EAAgB,aAAEwC,WAAW,iBAAiBjB,SAAS,CAAC,UAAYvB,EAAIwB,GAAGxB,EAAIyC,OAAOzB,GAAG,CAAC,MAAQhB,EAAI0C,aAAc1C,EAAY,SAAEI,EAAG,QAAQ,CAACA,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAO1B,EAAI2C,aAAa3C,EAAI4C,SAAS,OAAO,CAAC5C,EAAIkB,GAAG,OAAOd,EAAG,YAAY,CAACM,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,KAAO7C,EAAI4C,SAAS,OAAO,GAAG5C,EAAImB,QAASnB,EAAIc,SAAWd,EAAI8C,cAAe1C,EAAG,QAAQJ,EAAIqB,GAAIrB,EAAe,aAAE,SAAS+C,EAAIb,GACjpD,IAAIc,EAAeD,EAAI,GACnBE,EAAaF,EAAI,GACrB,OAAO3C,EAAG,UAAU,CAACd,IAAI4C,GAAK,CAAC9B,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQ,SAASU,GAAQ,OAAO1B,EAAIkD,eAAeF,MAAiB,CAAChD,EAAIkB,GAAG,OAAO,EAAad,EAAG,YAAY,CAACM,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,KAAOI,KAAcjD,EAAImB,MAAM,MAAK,GAAGnB,EAAImB,SAC/N,EAAkB,G,oFCJlB,EAAS,WAAa,IAAInB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAQF,EAAe,YAAEI,EAAG,IAAIJ,EAAImD,GAAG,CAAC7C,MAAM,QAAUN,EAAIoD,KAAKrB,KAAKf,GAAG,CAAC,MAAQhB,EAAIqD,kBAAkB,IAAIrD,EAAIsD,WAAU,GAAO,CAAEtD,EAAIoD,KAAS,KAAEhD,EAAG,OAAO,CAACJ,EAAIkB,GAAGlB,EAAIwB,GAAGxB,EAAIoD,KAAKX,SAASzC,EAAImB,KAAKnB,EAAIqB,GAAIrB,EAAIoD,KAAY,SAAE,SAASG,EAAMrB,GAAK,MAAO,CAAiB,SAAfqB,EAAMxB,MAAmB/B,EAAIwD,MAAMD,GAAO5G,OAAS,EAAGyD,EAAG,OAAOJ,EAAImD,GAAG,CAAC7D,IAAI4C,EAAI5B,MAAMN,EAAIwD,MAAMD,IAAQ,OAAOvD,EAAIyD,UAAUF,IAAO,GAAO,CAACvD,EAAIkB,GAAGlB,EAAIwB,GAAG+B,EAAMd,SAAyB,SAAfc,EAAMxB,KAAiB,CAAC/B,EAAIkB,GAAGlB,EAAIwB,GAAG+B,EAAMd,QAAQrC,EAAG,YAAY,CAACd,IAAI4C,EAAIxB,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,KAAOU,UAAa,GAAIvD,EAAY,SAAEI,EAAG,OAAOJ,EAAImD,GAAG,CAAC7C,MAAM,QAAUN,EAAIoD,KAAKrB,MAAM,OAAO/B,EAAIsD,WAAU,GAAO,CAAEtD,EAAIoD,KAAS,KAAEhD,EAAG,OAAO,CAACJ,EAAIkB,GAAGlB,EAAIwB,GAAGxB,EAAIoD,KAAKX,SAASzC,EAAImB,KAAKnB,EAAIqB,GAAIrB,EAAIoD,KAAY,SAAE,SAASG,EAAMrB,GAAK,MAAO,CAAiB,SAAfqB,EAAMxB,MAAmB/B,EAAIwD,MAAMD,GAAO5G,OAAS,EAAGyD,EAAG,OAAOJ,EAAImD,GAAG,CAAC7D,IAAI4C,EAAI5B,MAAMN,EAAIwD,MAAMD,IAAQ,OAAOvD,EAAIyD,UAAUF,IAAO,GAAO,CAACvD,EAAIkB,GAAGlB,EAAIwB,GAAG+B,EAAMd,SAAyB,SAAfc,EAAMxB,KAAiB,CAAC/B,EAAIkB,GAAGlB,EAAIwB,GAAG+B,EAAMd,QAAQrC,EAAG,YAAY,CAACd,IAAI4C,EAAIxB,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,KAAOU,UAAa,GAAGnD,EAAG,MAAMJ,EAAImD,GAAG,CAAC7C,MAAM,QAAUN,EAAIoD,KAAKrB,MAAM,MAAM/B,EAAIsD,WAAU,GAAO,CAACtD,EAAIqB,GAAIrB,EAAIoD,KAAY,SAAE,SAASG,EAAMrB,GAAK,MAAO,CAAiB,SAAfqB,EAAMxB,MAAmB/B,EAAIwD,MAAMD,GAAO5G,OAAS,EAAGyD,EAAG,OAAOJ,EAAImD,GAAG,CAAC7D,IAAI4C,EAAI5B,MAAMN,EAAIwD,MAAMD,IAAQ,OAAOvD,EAAIyD,UAAUF,IAAO,GAAO,CAACvD,EAAIkB,GAAGlB,EAAIwB,GAAG+B,EAAMd,SAAyB,SAAfc,EAAMxB,KAAiB,CAAC/B,EAAIkB,GAAGlB,EAAIwB,GAAG+B,EAAMd,QAAQrC,EAAG,YAAY,CAACd,IAAI4C,EAAIxB,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,KAAOU,UAAa,IACxiD,EAAkB,GCgCD,EAArB,6LAgDiBH,GACT,OAAIA,EAAKI,MACEJ,EAAKI,MAAME,KAAI,SAACC,GAAW,MAAO,QAAUA,EAAK5B,QAErD,KApDf,gCAuDqBqB,GACb,GAAIA,EAAKI,MAAO,CACZ,IAAM9C,EAAQ,GAUd,OATA0C,EAAKI,MAAMI,SAAQ,SAACD,GACZA,EAAKjD,OACL9D,OAAOiH,QAAQF,EAAKjD,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAC5CA,IACA0B,EAAM,QAAUpB,GAAON,SAKhC0B,EAEX,MAAO,KArEf,wCAyEQ,IAAMqB,EAAO9B,KAAK6D,QACd/B,GAAQ9B,KAAK8D,aAAe9D,KAAK+D,OAAOZ,KAAK1C,MAAMqB,EAAKkC,UAAUC,QAC7DjE,KAAKa,SAAsC,YAA3BiB,EAAKkC,UAAUE,QAKhClE,KAAKM,OAAO6D,OAAO,iBAAkB,CACjCC,KAAMpE,KAAK+D,OAAOnB,QAAU,WAAad,EAAKkC,UAAUlC,KAAO,IAAM9B,KAAK+D,OAAOZ,KAAK1C,MAAMqB,EAAKkC,UAAUC,MAAMI,UAAU,KAL/HrE,KAAKM,OAAO6D,OAAO,mBAAoB,CACnCC,KAAMpE,KAAK+D,OAAOnB,QAAU,WAAad,EAAKkC,UAAUlC,KAAO,IAAM9B,KAAK+D,OAAOZ,KAAK1C,MAAMqB,EAAKkC,UAAUC,MAAMI,UAAU,QA7E/I,8BAKQ,MAAqC,UAA9BrE,KAAKM,OAAOC,MAAMC,GAAGvB,OALpC,8BAUQ,IADA,IAAMqF,EAAStE,KAAKM,OAAOC,MAAMgE,SAASvE,KAAK+D,OAAOnB,SAAS0B,OACvDrC,EAAM,EAAGA,EAAMqC,EAAO5H,OAAQuF,IAClC,GAAIqC,EAAOrC,GAAK3D,OAAS0B,KAAK+D,OAAOZ,KAAKrB,KACtC,OAAOwC,EAAOrC,GAGtB,OAAO,OAff,gCAmBQ,IAAMxB,EAAQ,GAQd,OAPIT,KAAK+D,OAAOZ,KAAK1C,OACjB9D,OAAOiH,QAAQ5D,KAAK+D,OAAOZ,KAAK1C,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KACxDA,IACA0B,EAAM,QAAUpB,GAAON,MAI5B0B,IA3Bf,kCA+BQ,IAAMqB,EAAO9B,KAAK6D,QAClB,SAAI/B,IAAQA,EAAKkC,aAhCzB,+BAwCQ,IAAMlC,EAAO9B,KAAK6D,QAClB,SAAI/B,GAAsB,WAAdA,EAAKA,UAzCzB,GAAsC,QAC1B,gBAAP,kB,8BACO,gBAAP,kB,2BAFgB,EAAQ,gBAH5B,eAAU,CACPxD,KAAM,eAEW,WCjC8W,I,YCO/XkG,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,EAAAA,E,0DCjBD,SAAU,EAAIC,EAAUL,GAClC,IAAIM,EAAeN,EAAKO,MAAM,KAC9B,MAAOF,GAAOC,EAAahI,OAAS,EAAG,CACnC,GAA2B,MAAvBgI,EAAa,GAAG,IAA8D,MAAhDA,EAAa,GAAGA,EAAa,GAAGhI,OAAS,GAAY,CACnF,IAAMuF,EAAM2C,OAAOC,SAASH,EAAa,GAAGL,UAAU,EAAGK,EAAa,GAAGhI,OAAS,IAC9EuF,GAAO,GAAKA,EAAMwC,EAAI/H,SACtB+H,EAAMA,EAAIxC,SAGdwC,EAAMA,EAAIC,EAAa,IAE3BA,EAAeA,EAAa5E,MAAM,GAEtC,OAAO2E,E,gBCqCU,EAArB,6D,+DAGI,EAAAtC,cAA+B,GAHnC,+EA+EQnC,KAAK8E,eA/Eb,qCAsF0B9B,GAClBhD,KAAKM,OAAO6D,OAAO,mBAAoB,CAAEC,KAAMpB,MAvFvD,mCA0FwBA,GAChBhD,KAAKM,OAAO6D,OAAO,iBAAkB,CAAEC,KAAMpB,MA3FrD,iCA8FsBhB,GACd,IAAM+C,EAAUC,SAASC,cAAc,aAAejD,EAAU,MAChE,GAAI+C,EAAS,CACT,IAAMG,EAAYlF,KAAKmF,IAAIF,cAAc,iBACrCC,GACA,eAAMA,EAAUE,UAAWL,EAAQM,WAAW,SAACtG,GAAoBmG,EAAUE,UAAYrG,KAG7FiB,KAAKc,iBACLd,KAAKgB,oBAvGjB,wCA4GQhB,KAAKM,OAAO6D,OAAO,qBA5G3B,mCA+GwBmB,EAAaC,GAC7B,GAAIvF,MAAQA,KAAKmF,IAAK,CAClB,IAAMK,EAAmBxF,KAAK+B,SAAS0B,KAAI,SAACzB,GAAkC,MAAO,aAAeA,EAAQE,OAAS,QAAQuD,KAAK,MAClI,GAAyB,KAArBD,EAAyB,CAEzB,IAAME,EAAe9F,OAAO+F,aAAaC,QAAQ,cAC7CC,EAAY,GACZH,IACAG,EAAYC,KAAKC,MAAML,IAEtBG,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,cAChCH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAc,IAE5CH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,WACxDiD,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,SAAW,GAEtEiD,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,SAAW2C,EAAOH,UACzExF,OAAO+F,aAAaM,QAAQ,aAAcH,KAAKI,UAAUL,IAEzD,IAAM9D,EAAW/B,KAAKmF,IAAIgB,iBAAiBX,GAC3C,GAAIzD,EAASrF,OAAS,EAAG,CAErB,GADAsD,KAAKmC,cAAgB,KACjBoD,EAAOH,UAAY,EAAG,CACtB,IAAMgB,EAAUpG,KAAKmF,IAAIF,cAAc,WACnCmB,IACAb,EAAOH,UAAYG,EAAOH,UAAmC,IAAvBgB,EAAQC,cAGtD,IAAK,IAAIpE,EAAM,EAAGA,EAAMF,EAASrF,OAAQuF,IAAO,CAC5C,IAAMD,EAAUD,EAASE,GACzB,GAAIA,EAAMF,EAASrF,OAAS,EAAG,CAC3B,IAAM4J,EAAcvE,EAASE,EAAM,GAC/BsD,EAAOH,WAAapD,EAAQqD,WAAaE,EAAOH,UAAYkB,EAAYjB,YACxErF,KAAKmC,cAAgBH,EAAQuE,aAAa,iBAG1ChB,EAAOH,WAAapD,EAAQqD,YAC5BrF,KAAKmC,cAAgBH,EAAQuE,aAAa,kBApJ1E,gCA6JqBjB,GACb,IAAIpD,EAASoD,EAAGpD,OAChB,MAAOA,EAAQ,CACX,GAAyB,MAArBA,EAAOsE,UACP,MAEJtE,EAASA,EAAOuE,cAEhBvE,GAAUA,EAAOqE,aAAa,yBACqB,YAA/CrE,EAAOqE,aAAa,uBACc,UAA9BvG,KAAKM,OAAOC,MAAMC,GAAGvB,KACrBe,KAAKM,OAAO6D,OAAO,iBAAkB,CAAEC,KAAMlC,EAAOqE,aAAa,yBAEjEvG,KAAKM,OAAO6D,OAAO,mBAAoB,CAAEC,KAAMlC,EAAOqE,aAAa,yBAEjB,aAA/CrE,EAAOqE,aAAa,wBAC3BvG,KAAKM,OAAO6D,OAAO,iBAAkB,CAAEC,KAAMlC,EAAOqE,aAAa,4BA7KjF,mCAuLqB,WACPrB,EAAYlF,KAAKmF,IAAIF,cAAc,iBAEzC,GADAC,EAAUE,UAAY,EAClBxF,OAAO+F,cAAgB3F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAchG,KAAK+D,OAAOnB,QAAS,CAC/E,IAAM8C,EAAe9F,OAAO+F,aAAaC,QAAQ,cAC7CC,EAAY,GACZH,IACAG,EAAYC,KAAKC,MAAML,IAEtBG,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,cAChCH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAc,IAE5CH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,WACxDiD,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,SAAW,GAEtE,IAAM,EAAY5C,KAAKmF,IAAIF,cAAc,iBACzC,OAAIyB,UAAS,WACT,EAAUtB,UAAYS,EAAU,EAAKvF,OAAOC,MAAMC,GAAGwF,YAAY,EAAKjC,OAAOnB,YAEjFhD,OAAO+F,aAAaM,QAAQ,aAAcH,KAAKI,UAAUL,OA1MrE,iCAkNuBvH,EAAcgG,GAC7B,IAAK,IAAIrC,EAAM,EAAGA,EAAMqC,EAAO5H,OAAQuF,IACnC,GAAIqC,EAAOrC,GAAK3D,OAASA,EACrB,OAAOgG,EAAOrC,GAGtB,OAAO,OAxNf,8BA2NoBkB,GAAoB,WAChC,MAAkB,SAAdA,EAAKrB,MAAmBqB,EAAKX,KACtBW,EAAKX,KAERW,EAAKwD,QACExD,EAAKwD,QAAQlD,KAAI,SAACH,GAAY,OAAO,EAAKsD,QAAQtD,MAAWmC,KAAK,IAElE,KAlOvB,uCAuO6BtC,EAAsBmB,EAAavC,GACxD,GAAIoB,EAAM,CACN,IAAK,IAAIlB,EAAM,EAAGA,EAAMqC,EAAO5H,OAAQuF,IAC/BqC,EAAOrC,GAAK3D,OAAS6E,EAAKrB,MAAQwC,EAAOrC,GAAK4E,YAAc1D,EAAK1C,OAAS0C,EAAK1C,MAAM6D,EAAOrC,GAAK4E,WAAW5C,OAC5GlC,EAAS/E,KAAK,CACVkF,OAAQiB,EAAK1C,MAAM6D,EAAOrC,GAAK4E,WAAW5C,MAC1CzC,MAAOxB,KAAK4G,QAAQzD,KAIhC,GAAIA,EAAKwD,QACL,IAAK,IAAI,EAAM,EAAG,EAAMxD,EAAKwD,QAAQjK,OAAQ,IACzCsD,KAAK8G,iBAAiB3D,EAAKwD,QAAQ,GAAMrC,EAAQvC,MAnPrE,mCAyPyBoB,EAAsBmB,GACvC,IAAIyC,EAAe,GACnB,GAAI5D,EAAM,CACN,IAAM6D,EAAahH,KAAKgH,WAAW7D,EAAKrB,KAAMwC,GAC9C,GAAI0C,EAAY,CAqDZ,GApDwB,SAApBA,EAAW1I,KACP6E,EAAKI,QACLwD,EAAa/J,KAAK,iBAClBmG,EAAKI,MAAMI,SAAQ,SAACD,EAAMzB,GAClBA,EAAM,EACN8E,EAAa/J,KAAK,SAAW0G,EAAK5B,MAElCiF,EAAa/J,KAAK,QAAU0G,EAAK5B,SAGzCiF,EAAa/J,KAAK,KAClBmG,EAAKI,MAAMI,SAAQ,SAACD,GACZA,EAAKjD,OACL9D,OAAOiH,QAAQF,EAAKjD,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,WAI9DgI,EAAa/J,KAAK,MAEfgK,EAAWhD,WAClB+C,EAAa/J,KAAK,kBAAoBmG,EAAKrB,KAAO,KAC9CqB,EAAK1C,OACL9D,OAAOiH,QAAQT,EAAK1C,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,QAGtDoE,EAAK1C,OAASuG,EAAWhD,WAAagD,EAAWhD,UAAUC,MAAQd,EAAK1C,MAAMuG,EAAWhD,UAAUC,QACnG8C,EAAa/J,KAAK,yBAA2BgD,KAAK+D,OAAOnB,QAAU,WAAaoE,EAAWhD,UAAUlC,KAAO,IAAOqB,EAAK1C,MAAMuG,EAAWhD,UAAUC,MAAiBI,UAAU,GAAK,KACnL0C,EAAa/J,KAAK,yBAA2BgK,EAAWhD,UAAUE,QAAU,MAEhF6C,EAAa/J,KAAK,MACS,WAApBgK,EAAWlF,MAClBiF,EAAa/J,KAAK,qBAAuBmG,EAAKrB,KAAO,KACjDqB,EAAK1C,OACL9D,OAAOiH,QAAQT,EAAK1C,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,QAG1DgI,EAAa/J,KAAK,OAElB+J,EAAa/J,KAAK,oBAAsBmG,EAAKrB,KAAO,KAChDqB,EAAK1C,OACL9D,OAAOiH,QAAQT,EAAK1C,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,QAG1DgI,EAAa/J,KAAK,MAElBmG,EAAKX,MACLuE,EAAa/J,KAAKmG,EAAKX,MAEvBW,EAAKwD,QACL,IAAK,IAAI1E,EAAM,EAAGA,EAAMkB,EAAKwD,QAAQjK,OAAQuF,IAAO,CAChD,IAAMgF,EAAcjH,KAAKkH,aAAa/D,EAAKwD,QAAQ1E,GAAMqC,GACzDyC,EAAeA,EAAaI,OAAOF,GAGnB,SAApBD,EAAW1I,KACP6E,EAAKI,OACLwD,EAAa/J,KAAK,WAEfgK,EAAWhD,UAClB+C,EAAa/J,KAAK,QACS,WAApBgK,EAAWlF,KAClBiF,EAAa/J,KAAK,WAElB+J,EAAa/J,KAAK,eAEnB,GAAkB,QAAdmG,EAAKrB,MACRqB,EAAKwD,QACL,IAAK,IAAI,EAAM,EAAG,EAAMxD,EAAKwD,QAAQjK,OAAQ,IAAO,CAChD,IAAM,EAAcsD,KAAKkH,aAAa/D,EAAKwD,QAAQ,GAAMrC,GACzDyC,EAAeA,EAAaI,OAAO,IAKnD,OAAOJ,IA5Uf,8BASQ,MAAqC,UAA9B/G,KAAKM,OAAOC,MAAMC,GAAGvB,OATpC,sCAaQ,OAAOe,KAAKM,OAAOC,MAAMC,GAAGI,gBAbpC,0BAiBQ,IAAMwG,EAAcpH,KAAKM,OAAOC,MAAMoG,QAAQ3G,KAAK+D,OAAOnB,SAC1D,OAAIwE,GAAeA,EAAYC,IACpBD,EAAYC,IAEZ,OArBnB,oCA0BQ,SAAIrH,KAAKM,OAAOC,MAAMoG,QAAQ3G,KAAK+D,OAAOnB,SAAS0E,QAC3C3K,OAAO4K,KAAKvH,KAAKM,OAAOC,MAAMoG,QAAQ3G,KAAK+D,OAAOnB,SAAS0E,QAAQ5K,OAAS,KA3B5F,kCAkC0B,WAClB,OAAOsD,KAAKM,OAAOC,MAAMC,GAAG+D,SAASvE,KAAK+D,OAAOnB,SAAS4E,YAAY/D,KAAI,SAACT,GACvE,IAAMyE,EAAgB,EAAI,EAAKnH,OAAOC,MAAMoG,QAAS3D,GACrD,OAAIyE,EACO,CAACzE,EAAYyE,EAAcd,QAAQ,IAEnC,UAxCvB,+BA8CQ,IAAMhE,EAAW3C,KAAKM,OAAOC,MAAMC,GAAG+D,SAASvE,KAAK+D,OAAOnB,SAASD,SACpE,GAAIA,EAAU,CACV,IAAM+E,EAAc,EAAI1H,KAAKM,OAAOC,MAAMoG,QAAShE,GACnD,GAAI+E,EACA,MAAO,CAAC/E,EAAU+E,EAAYf,QAAQ,IAG9C,OAAO,OArDf,+BAyDQ,GAAI3G,KAAKqH,IAAK,CACV,IAAM/C,EAAStE,KAAKM,OAAOC,MAAMgE,SAASvE,KAAK+D,OAAOnB,SAAS0B,OACzDvC,EAAW,GAEjB,OADA/B,KAAK8G,iBAAiB9G,KAAKqH,IAAK/C,EAAQvC,GACjCA,EAEX,MAAO,KA/Df,6BAmEQ,OAAO/B,KAAKM,OAAOC,MAAMgE,SAASvE,KAAK+D,OAAOnB,SAAS0B,SAnE/D,2BAuEQ,OAAOtE,KAAKkH,aAAalH,KAAKqH,IAAKrH,KAAKsE,QAAQmB,KAAK,QAvE7D,GAAwC,QAC5B,gBAAP,kB,8BAsLD,gBADC,eAAM,Q,yBAsBN,MA5MgB,EAAU,gBAL9B,eAAU,CACPkC,WAAY,CACRC,SAAA,MAGa,WCnDgX,ICOjY,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,I,QClBX,EAAS,WAAa,IAAI7H,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAAO,CAACQ,YAAY,mBAAmB,CAAEZ,EAAIc,UAAYd,EAAIe,gBAAiBX,EAAG,MAAM,CAACE,MAAMN,EAAIe,gBAAkB,kBAAoB,MAAM,CAACX,EAAG,MAAM,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACA,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQhB,EAAIiB,kBAAkB,CAACjB,EAAIkB,GAAG,aAAad,EAAG,MAAM,CAACQ,YAAY,YAAY,CAACR,EAAG,KAAK,CAACA,EAAG,KAAK,CAACA,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQhB,EAAIiB,kBAAkB,CAACjB,EAAIkB,GAAGlB,EAAIwB,GAAGxB,EAAIO,OAAOC,MAAMgE,SAASxE,EAAI6C,SAASpB,kBAAkBzB,EAAImB,KAAKnB,EAAIqB,GAAIrB,EAAkB,gBAAE,SAAS8H,EAAM5F,GAAK,OAAO9B,EAAG,UAAU,CAACd,IAAI4C,GAAK,CAAC9B,EAAG,KAAK,CAACJ,EAAIkB,GAAGlB,EAAIwB,GAAGsG,EAAMrG,UAAUzB,EAAIqB,GAAIyG,EAAa,SAAE,SAASC,EAAMC,GAAM,OAAO5H,EAAG,iBAAiB,CAACd,IAAI0I,EAAKtH,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,OAASkF,EAAM,OAAS,UAAS,OAAM,IACpwB,EAAkB,GCDlB,EAAS,WAAa,IAAI/H,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAAqB,eAAnBJ,EAAIiI,OAAOlG,KAAuB,CAAC3B,EAAG,OAAO,CAACQ,YAAY,SAAS,CAACR,EAAG,OAAO,CAACQ,YAAY,SAAS,CAACZ,EAAIkB,GAAGlB,EAAIwB,GAAGxB,EAAIiI,OAAOxG,UAAUrB,EAAG,OAAO,CAACQ,YAAY,SAAS,CAACZ,EAAIkB,GAAGlB,EAAIwB,GAAGxB,EAAIhB,aAAagB,EAAImB,KAAyB,aAAnBnB,EAAIiI,OAAOlG,KAAqB,CAAC3B,EAAG,KAAK,CAACQ,YAAY,aAAaZ,EAAIqB,GAAIrB,EAAS,OAAE,SAAS7D,EAAK+F,GAAK,OAAO9B,EAAG,KAAK,CAACd,IAAI4C,GAAKlC,EAAIqB,GAAIrB,EAAIiI,OAAc,SAAE,SAASF,EAAMC,GAAM,OAAO5H,EAAG,iBAAiB,CAACd,IAAI0I,EAAKtH,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,OAASkF,EAAM,OAAS/H,EAAIkI,OAASlI,EAAIiI,OAAO5D,KAAO,KAAOnC,EAAM,UAAS,MAAK,IAAIlC,EAAImB,KAAyB,eAAnBnB,EAAIiI,OAAOlG,KAAuB,CAAC3B,EAAG,KAAK,CAACQ,YAAY,eAAeZ,EAAIqB,GAAIrB,EAAIiI,OAAc,SAAE,SAASF,EAAM7F,GAAK,OAAO9B,EAAG,KAAK,CAACd,IAAI4C,GAAK,CAAC9B,EAAG,iBAAiB,CAACM,MAAM,CAAC,QAAUV,EAAI6C,QAAQ,OAASkF,EAAM,OAAS/H,EAAIkI,OAASlI,EAAIiI,OAAO5D,SAAS,MAAK,IAAIrE,EAAImB,MAAM,IAC75B,EAAkB,GCgCD,EAArB,6LAMQ,IAAMnC,EAAQ,EAAIiB,KAAKM,OAAOC,MAAMoG,QAAQ3G,KAAK+D,OAAOnB,SAAU5C,KAAK+D,OAAOkE,OAASjI,KAAK+D,OAAOiE,OAAO5D,MAC1G,OAAIrF,GAGO,OAVnB,GAA2C,QAC/B,gBAAP,kB,6BACO,gBAAP,kB,8BACO,gBAAP,kB,6BAHgB,EAAa,gBAHjC,eAAU,CACPT,KAAM,oBAEW,WCjCmX,ICOpY,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,I,QCYM,EAArB,yMAuBQ0B,KAAKM,OAAO6D,OAAO,qBAvB3B,8BAOQ,MAAqC,UAA9BnE,KAAKM,OAAOC,MAAMC,GAAGvB,OAPpC,sCAWQ,OAAOe,KAAKM,OAAOC,MAAMC,GAAGI,gBAXpC,qCAeQ,OAAOZ,KAAKM,OAAOC,MAAMgE,SAASvE,KAAK+D,OAAOnB,SAASpC,OAf/D,GAA4C,QAChC,gBAAP,kB,8BADgB,EAAc,gBALlC,eAAU,CACPmH,WAAY,CACRO,cAAA,MAGa,WC9BoX,ICOrY,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,I,QClBX,EAAS,WAAa,IAAInI,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAAO,CAACQ,YAAY,sBAAsB,CAAEZ,EAAIc,UAAYd,EAAIe,gBAAiBX,EAAG,MAAM,CAACE,MAAMN,EAAIe,gBAAkB,kBAAoB,MAAM,CAACX,EAAG,MAAM,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACA,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQhB,EAAIiB,kBAAkB,CAACjB,EAAIkB,GAAG,aAAad,EAAG,MAAM,CAACQ,YAAY,YAAY,CAACR,EAAG,KAAK,CAACA,EAAG,KAAK,CAACA,EAAG,IAAI,CAACY,GAAG,CAAC,MAAQhB,EAAIiB,kBAAkB,CAACjB,EAAIkB,GAAGlB,EAAIwB,GAAGxB,EAAIO,OAAOC,MAAMgE,SAASxE,EAAI6C,SAASpB,kBAAkBzB,EAAImB,KAAKf,EAAG,UAAU,CAACA,EAAG,MAAM,CAACkC,WAAW,CAAC,CAAC/D,KAAK,SAASgE,QAAQ,WAAWvD,MAAOgB,EAAgB,aAAEwC,WAAW,iBAAiBjB,SAAS,CAAC,UAAYvB,EAAIwB,GAAGxB,EAAIyC,OAAOzB,GAAG,CAAC,MAAQhB,EAAI0C,kBAC/qB,EAAkB,GCgCD,EAArB,6D,+DAGI,EAAAN,cAA+B,GAHnC,+EAwDQnC,KAAK8E,eAxDb,wCAgEQ9E,KAAKM,OAAO6D,OAAO,qBAhE3B,mCAmEwBmB,EAAaC,GAC7B,GAAIvF,MAAQA,KAAKmF,IAAK,CAClB,IAAMO,EAAe9F,OAAO+F,aAAaC,QAAQ,cAC7CC,EAAY,GACZH,IACAG,EAAYC,KAAKC,MAAML,IAEtBG,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,cAChCH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAc,IAE5CH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,WACxDiD,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,SAAW,GAEtEiD,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,SAAW2C,EAAOH,UACzExF,OAAO+F,aAAaM,QAAQ,aAAcH,KAAKI,UAAUL,OAjFrE,gCAqFqBP,GACb,IAAIpD,EAASoD,EAAGpD,OAChB,MAAOA,EAAQ,CACX,GAAyB,MAArBA,EAAOsE,UACP,MAEJtE,EAASA,EAAOuE,cAEpB,IAAM0B,EAAgBjG,EAAOqE,aAAa,uBAC1C,GAAIrE,GAAUiG,EAAe,CACzB,IAAM/D,EAAO+D,EAAcxD,MAAM,KACjC,GAAIP,EAAK1H,OAAS,GAAK0H,EAAK,KAAOpE,KAAKoH,YAAYgB,QAAUhE,EAAK,IAAMpE,KAAKoH,YAAYiB,SAAU,CAChG,IAAMnD,EAAYlF,KAAKmF,IAAIF,cAAc,iBACnCF,EAAU/E,KAAKmF,IAAIF,cAAc,IAAMb,EAAK,IAC9Cc,GAAaH,GACb,eAAMG,EAAUE,UAAWL,EAAQM,WAAW,SAACtG,GAAoBmG,EAAUE,UAAYrG,SApG7G,mCA+GqB,WACPmG,EAAYlF,KAAKmF,IAAIF,cAAc,iBAEzC,GADAC,EAAUE,UAAY,EAClBxF,OAAO+F,cAAgB3F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAchG,KAAK+D,OAAOnB,QAAS,CAC/E,IAAM8C,EAAe9F,OAAO+F,aAAaC,QAAQ,cAC7CC,EAAY,GACZH,IACAG,EAAYC,KAAKC,MAAML,IAEtBG,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,cAChCH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAc,IAE5CH,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,WACxDiD,EAAU7F,KAAKM,OAAOC,MAAMC,GAAGwF,YAAYhG,KAAK+D,OAAOnB,SAAW,GAEtE,IAAM,EAAY5C,KAAKmF,IAAIF,cAAc,iBACzC,OAAIyB,UAAS,WACT,EAAUtB,UAAYS,EAAU,EAAKvF,OAAOC,MAAMC,GAAGwF,YAAY,EAAKjC,OAAOnB,YAEjFhD,OAAO+F,aAAaM,QAAQ,aAAcH,KAAKI,UAAUL,OAlIrE,iCA0IuBvH,EAAcgG,GAC7B,IAAK,IAAIrC,EAAM,EAAGA,EAAMqC,EAAO5H,OAAQuF,IACnC,GAAIqC,EAAOrC,GAAK3D,OAASA,EACrB,OAAOgG,EAAOrC,GAGtB,OAAO,OAhJf,8BAmJoBkB,GAAoB,WAChC,MAAkB,SAAdA,EAAKrB,MAAmBqB,EAAKX,KACtBW,EAAKX,KAERW,EAAKwD,QACExD,EAAKwD,QAAQlD,KAAI,SAACH,GAAY,OAAO,EAAKsD,QAAQtD,MAAWmC,KAAK,IAElE,KA1JvB,mCA+JyBtC,EAAsBmB,GACvC,IAAIyC,EAAe,GACnB,GAAI5D,EAAM,CACN,IAAM6D,EAAahH,KAAKgH,WAAW7D,EAAKrB,KAAMwC,GAC9C,GAAI0C,EAAY,CAqDZ,GApDwB,SAApBA,EAAW1I,KACP6E,EAAKI,QACLwD,EAAa/J,KAAK,iBAClBmG,EAAKI,MAAMI,SAAQ,SAACD,EAAMzB,GAClBA,EAAM,EACN8E,EAAa/J,KAAK,SAAW0G,EAAK5B,MAElCiF,EAAa/J,KAAK,QAAU0G,EAAK5B,SAGzCiF,EAAa/J,KAAK,KAClBmG,EAAKI,MAAMI,SAAQ,SAACD,GACZA,EAAKjD,OACL9D,OAAOiH,QAAQF,EAAKjD,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,WAI9DgI,EAAa/J,KAAK,MAEfgK,EAAWhD,WAClB+C,EAAa/J,KAAK,kBAAoBmG,EAAKrB,KAAO,KAC9CqB,EAAK1C,OACL9D,OAAOiH,QAAQT,EAAK1C,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,QAGtDoE,EAAK1C,OAASuG,EAAWhD,WAAagD,EAAWhD,UAAUC,MAAQd,EAAK1C,MAAMuG,EAAWhD,UAAUC,QACnG8C,EAAa/J,KAAK,yBAA2BgD,KAAK+D,OAAOnB,QAAU,WAAaoE,EAAWhD,UAAUlC,KAAO,IAAOqB,EAAK1C,MAAMuG,EAAWhD,UAAUC,MAAiBI,UAAU,GAAK,KACnL0C,EAAa/J,KAAK,yBAA2BgK,EAAWhD,UAAUE,QAAU,MAEhF6C,EAAa/J,KAAK,MACS,WAApBgK,EAAWlF,MAClBiF,EAAa/J,KAAK,qBAAuBmG,EAAKrB,KAAO,KACjDqB,EAAK1C,OACL9D,OAAOiH,QAAQT,EAAK1C,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,QAG1DgI,EAAa/J,KAAK,OAElB+J,EAAa/J,KAAK,oBAAsBmG,EAAKrB,KAAO,KAChDqB,EAAK1C,OACL9D,OAAOiH,QAAQT,EAAK1C,OAAOkD,SAAQ,YAAiB,0BAAftE,EAAe,KAAVN,EAAU,KAChDgI,EAAa/J,KAAK,SAAWqC,EAAM,KAAON,EAAQ,QAG1DgI,EAAa/J,KAAK,MAElBmG,EAAKX,MACLuE,EAAa/J,KAAKmG,EAAKX,MAEvBW,EAAKwD,QACL,IAAK,IAAI1E,EAAM,EAAGA,EAAMkB,EAAKwD,QAAQjK,OAAQuF,IAAO,CAChD,IAAMgF,EAAcjH,KAAKkH,aAAa/D,EAAKwD,QAAQ1E,GAAMqC,GACzDyC,EAAeA,EAAaI,OAAOF,GAGnB,SAApBD,EAAW1I,KACP6E,EAAKI,OACLwD,EAAa/J,KAAK,WAEfgK,EAAWhD,UAClB+C,EAAa/J,KAAK,QACS,WAApBgK,EAAWlF,KAClBiF,EAAa/J,KAAK,WAElB+J,EAAa/J,KAAK,eAEnB,GAAkB,QAAdmG,EAAKrB,MACRqB,EAAKwD,QACL,IAAK,IAAI,EAAM,EAAG,EAAMxD,EAAKwD,QAAQjK,OAAQ,IAAO,CAChD,IAAM,EAAcsD,KAAKkH,aAAa/D,EAAKwD,QAAQ,GAAMrC,GACzDyC,EAAeA,EAAaI,OAAO,IAKnD,OAAOJ,IAlPf,8BASQ,MAAqC,UAA9B/G,KAAKM,OAAOC,MAAMC,GAAGvB,OATpC,sCAaQ,OAAOe,KAAKM,OAAOC,MAAMC,GAAGI,gBAbpC,kCAiBQ,OAAOZ,KAAKM,OAAOC,MAAMgE,SAASvE,KAAK+D,OAAOnB,WAjBtD,2BAqBQ,IAAMwE,EAAcpH,KAAKM,OAAOC,MAAMoG,QAAQ3G,KAAKoH,YAAYgB,QAC/D,OAAIhB,GAAeA,EAAYE,QAAUF,EAAYE,OAAOtH,KAAKoH,YAAYiB,UAClEjB,EAAYE,OAAOtH,KAAKoH,YAAYiB,UAEpC,OAzBnB,6BA8BQ,OAAOrI,KAAKM,OAAOC,MAAMgE,SAASvE,KAAKoH,YAAYgB,QAAQ9D,SA9BnE,2BAiCmB,WACX,GAAItE,KAAKsI,KAAM,CACX,IAAIC,EAAQ,CAAC,QASb,OARA5L,OAAOiH,QAAQ5D,KAAKsI,MAAM3E,SAAQ,YAAe,0BAAb6E,EAAa,KAATrF,EAAS,KACzCA,EAAKwD,SAAWxD,EAAKwD,QAAQjK,OAAS,IACtC6L,EAAMvL,KAAK,WAAawL,EAAK,MAC7BD,EAAQA,EAAMpB,OAAO,EAAKD,aAAa/D,EAAKwD,QAAQ,GAAI,EAAKrC,SAC7DiE,EAAMvL,KAAK,aAGnBuL,EAAMvL,KAAK,SACJuL,EAAM9C,KAAK,IAGlB,OAAO,SA/CnB,GAA8C,QAClC,gBAAP,kB,8BA8GD,gBADC,eAAM,Q,yBAsBN,MApIgB,EAAgB,gBALpC,eAAU,CACPkC,WAAY,CACRC,SAAA,MAGa,WCjCsX,ICOvY,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,I,QCsBM,GAArB,qMA8ByBvI,GACjBW,KAAKM,OAAO6D,OAAO,gBAAiB9E,GAChCW,KAAKa,SACLb,KAAKM,OAAO6D,OAAO,qBAjC/B,wCAsCQnE,KAAKM,OAAO6D,OAAO,qBAtC3B,8BA0CYnE,KAAKa,SACLb,KAAKM,OAAO6D,OAAO,mBAEvBnE,KAAK4B,kBA7Cb,8BAEQ,MAAqC,UAA9B5B,KAAKM,OAAOC,MAAMC,GAAGvB,OAFpC,sCAMQ,OAAOe,KAAKM,OAAOC,MAAMC,GAAGI,gBANpC,0CAUQ,OAAOjE,OAAO4K,KAAKvH,KAAKM,OAAOC,MAAMgE,UAAU7H,OAAS,IAVhE,+BAcQ,OAAOsD,KAAKM,OAAOC,MAAMgE,WAdjC,sCAkBQ,OAAOvE,KAAKM,OAAOC,MAAMC,GAAGa,kBAlBpC,iCAuBQ,OAAOrB,KAAKM,OAAOC,MAAMC,GAAGmB,aAvBpC,oCA2BQ,OAAO3B,KAAKM,OAAOC,MAAMkI,UAAU5G,UA3B3C,GAAuC,QAAlB,GAAS,gBAP7B,eAAU,CACP8F,WAAY,CACRe,WAAA,EACAC,eAAA,EACAC,iBAAA,MAGa,cCxC+W,MCOhY,GAAY,eACd,GACA,EACA,GACA,EACA,KACA,KACA,MAIa,M,QCHM,GAArB,iMACkB,WACJC,EAAgB7D,SAAS8D,eAAe,mBAC9C,GAAID,EAAe,CACf,IAAMb,EAASlC,KAAKC,MAAM8C,EAAcE,WACpCf,GACAhI,KAAKM,OAAO6D,OAAO,OAAQ6D,GAG/BhI,KAAKM,OAAOC,MAAMkI,WAAazI,KAAKM,OAAOC,MAAMkI,UAAUO,UAC3DhJ,KAAKM,OAAOC,MAAMkI,UAAUO,UAAS,SAACC,GAClC,EAAK3I,OAAO4I,SAAS,OAAQD,MAGrCjJ,KAAKmJ,mBACLvJ,OAAOwJ,iBAAiB,SAAUpJ,KAAKmJ,oBAf/C,sCAmBQvJ,OAAOyJ,oBAAoB,SAAUrJ,KAAKmJ,oBAnBlD,yCAuBYvJ,OAAO0J,WAAa,KACpBtJ,KAAKM,OAAO6D,OAAO,UAAW,SAE9BnE,KAAKM,OAAO6D,OAAO,UAAW,aA1B1C,GAAiC,QAAZ,GAAG,gBALvB,eAAU,CACTwD,WAAY,CACV4B,UAAA,OAGiB,cCfuV,MCQxW,I,UAAY,eACd,GACA,EACA7I,GACA,EACA,KACA,KACA,OAIa,M,2CCnBf,SAAS8I,GAAWC,GAChB,MAAe,QAAXA,EACO,8BACW,QAAXA,EACA,uCAEA,8B,IAIM,G,WAGjB,WAAaC,GAAgB,uBACzB1J,KAAK0J,IAAMA,E,wDAGNvG,EAAYwG,EAAeC,GAChC,OAAO5J,KAAK0J,IAAIG,SAASF,EAAOxG,EAAMqG,GAAYI,EAAY,Q,gCAGxDzG,EAAYwG,GAClB,OAAO3J,KAAK6J,SAAS1G,EAAMwG,EAAOG,YAAYC,yBAAyBC,kB,mCAG9D7G,EAAYwG,GACrB,OAAO3J,KAAK6J,SAAS1G,EAAMwG,EAAOG,YAAYG,8B,kCAGtC9G,EAAYwG,GACpB,OAAO3J,KAAK6J,SAAS1G,EAAMwG,EAAOG,YAAYI,aAAaC,c,mCAGlDhH,EAAYwG,GACrB,OAAO3J,KAAK6J,SAAS1G,EAAMwG,EAAOG,YAAYM,cAAcC,e,kCAGpDlH,EAAYwG,GACpB,OAAO3J,KAAK6J,SAAS1G,EAAMwG,EAAOG,YAAYQ,aAAaC,gB,KCnC9C,G,WAMjB,WAAYb,EAAkB1B,GAAW,uBACrChI,KAAK0J,IAAMA,EACX1J,KAAK2J,MAAQ,IAAI,GAAe3J,KAAK0J,KACrC1J,KAAKgI,OAASA,E,qDAId,IAAKhI,KAAK9D,KAAM,CACZ,IAAMsO,EAASxK,KAAK2J,MAAMc,UAAUzK,KAAK0J,IAAIgB,gBAAiB,0BAC9D1K,KAAK9D,KAAO,GACZ,IAAK,IAAI+F,EAAM,EAAGA,EAAMjC,KAAKgI,OAAO1D,OAAO5H,OAAQuF,IAAO,CACtD,IAAM0I,EAAO3K,KAAK4K,gBAAgBJ,EAAQxK,KAAKgI,OAAO1D,OAAOrC,IACzD0I,IACA3K,KAAK9D,KAAK8D,KAAKgI,OAAO1D,OAAOrC,GAAK4I,IAAIxG,UAAU,IAAMsG,IAIlE,OAAO3K,KAAK9D,O,sCAGQiH,EAAemB,GACnC,IAAMwG,EAAW9K,KAAK2J,MAAMoB,aAAa5H,EAAMmB,EAAOuG,KAChDtN,EAAS,GACXwH,EAAU+F,EAASE,cACvB,MAAOjG,EAAS,CAKZ,IAJA,IAAMN,EAAM,CACRwG,OAAQ,GACRC,MAAmC,IAA5BnG,EAAQoG,SAASzO,OAAesD,KAAK2J,MAAMQ,YAAYpF,EAAS,UAAY,MAE/E9C,EAAM,EAAGA,EAAM8C,EAAQqG,WAAW1O,OAAQuF,IAC9CwC,EAAIwG,OAAOlG,EAAQqG,WAAWnJ,GAAK3D,MAAQyG,EAAQqG,WAAWnJ,GAAKlD,MAEvE,GAAIuF,EAAO6G,SACP,IAAK,IAAI,EAAM,EAAG,EAAM7G,EAAO6G,SAASzO,OAAQ,IAAO,CACnD,IAAMiO,EAAO3K,KAAK4K,gBAAgB7F,EAAST,EAAO6G,SAAS,IACvDR,IACAlG,EAAIH,EAAO6G,SAAS,GAAKN,IAAIxG,UAAUC,EAAO6G,SAAS,GAAKN,IAAIQ,QAAQ,KAAO,IAAMV,GAIjGpN,EAAOP,KAAKyH,GACZM,EAAU+F,EAASE,cAEvB,OAAsB,IAAlBzN,EAAOb,OACA,KAEH4H,EAAOgH,SACA/N,EAEAA,EAAO,O,KCtDT,G,WAOjB,WAAYmM,EAAkB1B,GAA2B,uBAHjD,KAAAX,IAA6B,KAC7B,KAAAkE,WAA2B,GAG/BvL,KAAK0J,IAAMA,EACX1J,KAAK2J,MAAQ,IAAI,GAAe3J,KAAK0J,KACrC1J,KAAKgI,OAASA,E,qDAId,IAAKhI,KAAKqH,MACNrH,KAAKqH,IAAM,CACPvF,KAAM,MACN6E,QAAS,IAEb3G,KAAKuL,WAAa,GACdvL,KAAKgI,OAAOwD,QAAUxL,KAAKgI,OAAOwD,OAAOC,UAAU,CACnD,IAAMtI,EAAOnD,KAAK2J,MAAMc,UAAUzK,KAAK0J,IAAIgB,gBAAiB1K,KAAKgI,OAAOwD,OAAOC,UAC/E,GAAItI,EACA,IAAI,IAAIlB,EAAM,EAAGA,EAAMkB,EAAKgI,SAASzO,OAAQuF,IAAO,CAChD,IAAMyJ,EAAM1L,KAAK2L,iBAAiBxI,EAAKgI,SAASlJ,GAAMjC,KAAKgI,QACvD0D,IAAQA,EAAIE,WAAa5L,KAAKqH,IAAIV,QAClC3G,KAAKqH,IAAIV,QAAQ3J,KAAK0O,GACfA,GAAOA,EAAIE,WAClB5L,KAAK6L,aAAaH,IAMtC,MAAO,CAAC1L,KAAKqH,IAAKrH,KAAKuL,c,6CAGIpI,EAAe1C,GAA4B,WAEhElD,EAAS,GAoCf,OAnCAZ,OAAOiH,QAAQnD,GAAOkD,SAAQ,YAAkB,0BAAhBtE,EAAgB,KAAXiF,EAAW,KACxCwH,EAAU,GACVxH,EAAOkH,OACPM,EAAQ9O,KAAKsH,EAAOkH,QACblH,EAAOwH,UACdA,EAAUxH,EAAOwH,SAErB,IAAK,IAAI7J,EAAM,EAAGA,EAAM6J,EAAQpP,OAAQuF,IAAO,CAC3C,IAAMuJ,EAASM,EAAQ7J,GACvB,GAAoB,YAAhBuJ,EAAO1J,KACPvE,EAAO8B,GAAO,EAAKsK,MAAMU,aAAalH,EAAMqI,EAAOC,eAChD,GAAoB,WAAhBD,EAAO1J,KACd,IACIvE,EAAO8B,GAAO,EAAKsK,MAAMY,YAAYpH,EAAMqI,EAAOC,UACpD,MAAMM,GAEJC,QAAQC,IAAIF,QAEb,GAAoB,WAAhBP,EAAO1J,KACV,EAAK6H,MAAMU,aAAalH,EAAMqI,EAAOC,YACrClO,EAAO8B,GAAOmM,EAAOzM,YAGzB,IACI,IAAMA,EAAQ,EAAK4K,MAAMQ,YAAYhH,EAAMqI,EAAOC,UAC9C1M,IACAxB,EAAO8B,GAAON,GAEpB,MAAMgN,GAEJC,QAAQC,IAAIF,QAKrBxO,I,wCAGe4F,EAAemB,GAAyB,WAExD/G,EAAS,GAsBf,OArBA+G,EAAOX,SAAQ,SAACmE,GACZ,GAAmB,SAAfA,EAAMhG,KAAiB,CACvB,IAAIgK,EAAU,GACVhE,EAAM0D,OACNM,EAAQ9O,KAAK8K,EAAM0D,QACZ1D,EAAMgE,UACbA,EAAUhE,EAAMgE,SAEpB,IAAK,IAAI7J,EAAM,EAAGA,EAAM6J,EAAQpP,OAAQuF,IACpC,GAAI,EAAK0H,MAAMU,aAAalH,EAAM2I,EAAQ7J,GAAKwJ,UAAW,CACtD,IAAM/H,EAAO,CACT5B,KAAMgG,EAAMxJ,MAEZwJ,EAAMrH,QACNiD,EAAKjD,MAAQ,EAAKyL,uBAAuB/I,EAAM2E,EAAMrH,QAEzDlD,EAAOP,KAAK0G,QAKrBnG,I,uCAGc4F,EAAeP,GAGpC,IADA,IAAMgB,EAAUjH,OAAOiH,QAAQhB,EAAQ0B,QAC9BrC,EAAM,EAAGA,EAAM2B,EAAQlH,OAAQuF,IAAO,CAE3C,IAAM+E,EAAapD,EAAQ3B,GAAK,GAC5B6J,EAAU,GACV9E,EAAWwE,OACXM,EAAQ9O,KAAKgK,EAAWwE,QACjBxE,EAAW8E,UAClBA,EAAUA,EAAQ3E,OAAOH,EAAW8E,UAExC,IAAK,IAAI/D,EAAO,EAAGA,EAAO+D,EAAQpP,OAAQqL,IAAQ,CAC9C,IAAMyD,EAASM,EAAQ/D,GACvB,GAA+D,OAA3D/H,KAAK2J,MAAMc,UAAUtH,EAAM,SAAWqI,EAAOC,UAAoB,CAEjE,IAAMlO,EAAS,CACXuE,KAAMkF,EAAW1I,MAQrB,GANI0I,EAAWvG,QACXlD,EAAOkD,MAAQT,KAAKkM,uBAAuB/I,EAAM6D,EAAWvG,QAExC,WAApBuG,EAAWlF,OACXvE,EAAOqO,WAAY,GAEC,WAApB5E,EAAWlF,KAEX,GAAwB,SAApBkF,EAAW1I,MAKX,GAJIkN,EAAOhJ,OACPjF,EAAOiF,KAAOxC,KAAK2J,MAAMQ,YAAYhH,EAAMqI,EAAOhJ,OAEtDjF,EAAOgG,MAAQvD,KAAKmM,kBAAkBhJ,EAAMP,EAAQ0B,QACvB,IAAzBnB,EAAKgI,SAASzO,OAAc,CAC5B,IAAMiO,EAAO3K,KAAK2L,iBAAiBxI,EAAKgI,SAAS,GAAIvI,GACjD+H,GAAQA,EAAKnI,MAAsB,KAAdmI,EAAKnI,OAC1BjF,EAAOiF,KAAOmI,EAAKnI,MAEnBmI,GAAQA,EAAKpH,QACbhG,EAAOgG,MAAQhG,EAAOgG,MAAM4D,OAAOwD,EAAKpH,cAIhD,GAA6B,IAAzBJ,EAAKgI,SAASzO,OAEV8O,EAAOhJ,MAAQxC,KAAK2J,MAAMQ,YAAYhH,EAAMqI,EAAOhJ,QACnDjF,EAAOoJ,QAAU,CACb,CACI7E,KAAM,OACNU,KAAMxC,KAAK2J,MAAMQ,YAAYhH,EAAMqI,EAAOhJ,MAC1Ce,MAAOvD,KAAKmM,kBAAkBhJ,EAAMP,EAAQ0B,eAIrD,CAEH,IADA,IAAMqC,EAAU,GACPyF,EAAO,EAAGA,EAAOjJ,EAAKgI,SAASzO,OAAQ0P,IAAQ,CACpD,IAAM9I,EAAQtD,KAAK2L,iBAAiBxI,EAAKgI,SAASiB,GAAOxJ,GACrDU,GACAqD,EAAQ3J,KAAKsG,GAGrB/F,EAAOoJ,QAAUA,MAGtB,CAEH,IADA,IAAM,EAAU,GACP,EAAO,EAAG,EAAOxD,EAAKgI,SAASzO,OAAQ,IAAQ,CACpD,IAAM,EAAQsD,KAAK2L,iBAAiBxI,EAAKgI,SAAS,GAAOvI,GACrD,IAAU,EAAMgJ,UAChB,EAAQ5O,KAAK,GACN,GAAS,EAAM4O,WACtB5L,KAAK6L,aAAa,GAG1BtO,EAAOoJ,QAAU,EAErB,OAAOpJ,IAInB,OAAO,O,mCAGU8O,GACjB,GAAIA,EAAa5L,OAAS4L,EAAa5L,MAAM+H,GAAI,CACxCxI,KAAKuL,WAAWc,EAAavK,QAC9B9B,KAAKuL,WAAWc,EAAavK,MAAQ,IAEzC9B,KAAKuL,WAAWc,EAAavK,MAAMuK,EAAa5L,MAAM+H,IAAM6D,EAC5D,IAAMT,EAAY,CACd9J,KAAM,MACN6E,QAAS0F,EAAa1F,SAE1B0F,EAAa1F,QAAU,CAACiF,Q,kBCvMtB,SAAUU,GAAU7H,GAC9B,QAAY8H,IAAR9H,EAAJ,CAEO,GAAY,OAARA,EACP,OAAO,KACJ,GAAI+H,MAAMC,QAAQhI,GACrB,OAAOA,EAAIhB,KAAI,SAACiJ,GACZ,OAAOJ,GAAUI,MAElB,GAAoB,WAAhB,gBAAOjI,GAAmB,CACjC,IAAMkI,EAAQ,GAId,OAHAhQ,OAAO4K,KAAK9C,GAAKd,SAAQ,SAAStE,GAC9BsN,EAAMtN,GAAOiN,GAAU7H,EAAIpF,OAExBsN,EAEP,OAAOlI,GCXf,OAAImI,IAAI,SAEO,WAAI,QAAKC,MAAM,CAC1BtM,MAAO,CACHoG,QAAS,GAET8B,UAAW,GAEXlE,SAAU,GAEV/D,GAAI,CACAvB,KAAM,QACN2B,eAAe,EACfS,gBAAiB,KACjBkD,SAAU,GACV5C,WAAY,KACZqE,WAAY,KAGpB8G,UAAW,CACPC,KADO,SACFxM,EAAOyH,GACRzH,EAAMgE,SAAWyD,EAAOzD,SACxB5H,OAAO4K,KAAKS,EAAOzD,UAAUZ,SAAQ,SAACtE,EAAK4C,GACvC,OAAI+K,IAAIzM,EAAMoG,QAAStH,EAAK,IACM,SAA9B2I,EAAOzD,SAASlF,GAAKyC,OACrB,OAAIkL,IAAIzM,EAAMoG,QAAQtH,GAAM,MAAO,MACnC,OAAI2N,IAAIzM,EAAMoG,QAAQtH,GAAM,SAAU,KAG1C,OAAI2N,IAAIzM,EAAMC,GAAG+D,SAAUlF,EAAK,IACE,SAA9B2I,EAAOzD,SAASlF,GAAKyC,OACrB,OAAIkL,IAAIzM,EAAMC,GAAG+D,SAASlF,GAAM,cAAe,IAC/C,OAAI2N,IAAIzM,EAAMC,GAAG+D,SAASlF,GAAM,WAAY,OAGpC,IAAR4C,IACA1B,EAAMC,GAAGa,gBAAkBhC,MAK/BO,OAAOqN,WAAarN,OAAOqN,UAAUxE,YAGrC,OAAIuE,IAAIzM,EAAMkI,UAAW,WAAY7I,OAAOqN,UAAUxE,UAAUO,UAGhE,OAAIgE,IAAIzM,EAAMkI,UAAW,QAAS7I,OAAOqN,UAAUxE,UAAU5G,QAE7DmG,EAAOxH,IAAMwH,EAAOxH,GAAGmB,aACvBpB,EAAMC,GAAGmB,WAAaqG,EAAOxH,GAAGmB,aAIxCuL,WAnCO,SAmCI3M,EAAO4M,GACd,IAAM/I,EAAO+I,EAAQ/I,KAAKO,MAAM,KACZ,IAAhBP,EAAK1H,OACL,OAAIsQ,IAAIzM,EAAMoG,QAAQvC,EAAK,IAAKA,EAAK,GAAI+I,EAAQ9F,KAC3B,IAAhBjD,EAAK1H,QACX,OAAIsQ,IAAIzM,EAAMoG,QAAQvC,EAAK,IAAIkD,OAAOlD,EAAK,IAAIA,EAAK,IAAK,UAAW,CAAC+I,EAAQ9F,OAIrFwE,aA5CO,SA4CMtL,EAAO4M,GAChB,IAAM/I,EAAO+I,EAAQ/I,KAAKO,MAAM,KACZ,IAAhBP,EAAK1H,SACA6D,EAAMoG,QAAQvC,EAAK,IAAIkD,OAAOlD,EAAK,KACpC,OAAI4I,IAAIzM,EAAMoG,QAAQvC,EAAK,IAAIkD,OAAQlD,EAAK,GAAI,IAEpD,OAAI4I,IAAIzM,EAAMoG,QAAQvC,EAAK,IAAIkD,OAAOlD,EAAK,IAAKA,EAAK,GAAI,CACrD3D,MAAO,CACH+H,GAAIpE,EAAK,IAEbuC,QAAS,CACLwG,EAAQ9F,KAEZuE,WAAW,EACX9J,KAAMsC,EAAK,OAKvBgJ,YA/DO,SA+DK7M,EAAO4M,GACf,OAAIH,IAAIzM,EAAMoG,QAASwG,EAAQ/I,KAAM+I,EAAQE,WAGjD3L,cAnEO,SAmEOnB,EAAOqC,GACjBrC,EAAMC,GAAGa,gBAAkBuB,GAG/B0K,iBAvEO,SAuEU/M,EAAO4M,GACpB,IAAM/I,EAAO+I,EAAQ/I,KAAKO,MAAM,KAChC,GAAoB,IAAhBP,EAAK1H,OAAc,CACnB,IAAM8K,EAAc8E,GAAU/L,EAAMC,GAAG+D,SAASH,EAAK,IAAIoD,aACrDA,EAAY6D,QAAQ8B,EAAQ/I,OAAS,EACrCoD,EAAY5J,OAAO4J,EAAY6D,QAAQ8B,EAAQ/I,MAAO,GAEtDoD,EAAYxK,KAAKmQ,EAAQ/I,MAE7B,OAAI4I,IAAIzM,EAAMC,GAAG+D,SAASH,EAAK,IAAK,cAAeoD,KAI3D+F,eApFO,SAoFQhN,EAAO4M,GAClB,IAAM/I,EAAO+I,EAAQ/I,KAAKO,MAAM,KACZ,IAAhBP,EAAK1H,SACD6D,EAAMC,GAAG+D,SAASH,EAAK,IAAIzB,WAAawK,EAAQ/I,KAChD,OAAI4I,IAAIzM,EAAMC,GAAG+D,SAASH,EAAK,IAAK,WAAY,MAEhD,OAAI4I,IAAIzM,EAAMC,GAAG+D,SAASH,EAAK,IAAK,WAAY+I,EAAQ/I,QAKpEpD,gBA/FO,SA+FST,GACZA,EAAMC,GAAGI,eAAiBL,EAAMC,GAAGI,eAGvC4M,QAnGO,SAmGCjN,EAAO4M,GACX5M,EAAMC,GAAGvB,KAAOkO,GAGpBM,iBAvGO,SAuGUlN,EAAO4M,GACpB5M,EAAMC,GAAGwF,WAAamH,IAG9BO,QAAS,CACLC,KADK,WACmBC,GAA4B,IAA7CzJ,EAA6C,EAA7CA,OAAQ5D,EAAqC,EAArCA,MACX4D,EAAO,mBAAoByJ,EAAO5H,YAClC,IAAM6H,EAAY,IAAIC,UAChBpE,EAAMmE,EAAUE,gBAAgBH,EAAOjH,QAAS,mBACtD,OAAIqG,IAAIzM,EAAO,UAAW,IAC1B5D,OAAO4K,KAAKhH,EAAMgE,UAAUZ,SAAQ,SAACtE,GACjC,OAAI2N,IAAIzM,EAAMoG,QAAStH,EAAK,IAC5B,OAAI2N,IAAIzM,EAAMoG,QAAQtH,GAAM,MAAO,MACnC,OAAI2N,IAAIzM,EAAMoG,QAAQtH,GAAM,SAAU,OAE1C1C,OAAOiH,QAAQrD,EAAMgE,UAAUZ,SAAQ,YAAkB,0BAAhBtE,EAAgB,KAAX2I,EAAW,KACrD,GAAoB,aAAhBA,EAAOlG,KACPqC,EAAO,cAAe,CAAEC,KAAM/E,EAAKgO,SAAW,IAAI,GAAkB3D,EAAK1B,GAASrJ,aAC/E,GAAoB,SAAhBqJ,EAAOlG,KAAiB,OACJ,IAAI,GAAc4H,EAAK1B,GAASrJ,MAD5B,sBACxB0I,EADwB,KACnBkE,EADmB,KAE/BpH,EAAO,aAAc,CAAEC,KAAM/E,EAAM,OAAQgI,IAAKA,IAChD1K,OAAOiH,QAAQ2H,GAAY5H,SAAQ,YAAsB,0BAApBqK,EAAoB,KAAT1F,EAAS,KACrD3L,OAAOiH,QAAQ0E,GAAM3E,SAAQ,YAAkB,0BAAhBsK,EAAgB,KAAR5G,EAAQ,KACvCA,EAAIV,SACJxC,EAAO,eAAgB,CAACC,KAAM/E,EAAM,WAAa2O,EAAY,IAAMC,EAAQ5G,IAAKA,EAAIV,QAAQ,iBAQxH1J,QAAS,K,aC3Jb,OAAI2P,IAAI,QAAW,CAAEsB,SAAU,KAE/B,OAAIlG,OAAOmG,eAAgB,EAE3B,IAAI,OAAI,CACNC,SACAC,OAAQ,SAAAC,GAAC,OAAIA,EAAE,OACdC,OAAO","file":"js/app.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:'mode-' + this.$store.state.ui.mode,attrs:{\"id\":\"app\"}},[_c('TeiReader')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tei-reader\"},[_c('div',{class:this.$store.state.ui.smallMenuOpen ? 'small-menu-open' : null},[(_vm.isSmall && _vm.isSmallMenuOpen)?_c('nav',[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]):_vm._e(),((!_vm.isSmall && _vm.hasMultipleSections) || (_vm.isSmall && _vm.isSmallMenuOpen))?_c('nav',[_c('ul',{attrs:{\"role\":\"menubar\"}},[_vm._l((_vm.sections),function(value,key){return _c('li',{key:key,attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-checked\":key === _vm.selectedSection ? 'true' : 'false'},domProps:{\"innerHTML\":_vm._s(value.label)},on:{\"click\":function($event){return _vm.selectSection(key)}}})])}),(_vm.closeLabel && _vm.closeCallback)?_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\"},domProps:{\"innerHTML\":_vm._s(_vm.closeLabel)},on:{\"click\":_vm.close}})]):_vm._e()],2)]):_vm._e()]),_vm._l((_vm.sections),function(value,key){return [(key === _vm.selectedSection && value.type === 'Text')?_c('text-reader',{key:key,attrs:{\"section\":key}}):(key === _vm.selectedSection && value.type === 'Metadata')?_c('metadata-reader',{key:key,attrs:{\"section\":key}}):(key === _vm.selectedSection && value.type === 'NestedList')?_c('nested-list-reader',{key:key,attrs:{\"section\":key}}):_vm._e()]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{staticClass:\"text-reader\"},[(_vm.isSmall && _vm.headings.length > 0)?_c('div',{class:_vm.isSmallMenuOpen ? 'small-menu-open' : null},[_c('nav',[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]),_c('nav',{staticClass:\"vertical\"},[_c('ul',[_vm._l((_vm.headings),function(heading,idx){return [(heading.target === _vm.activeHeading || (!_vm.activeHeading && idx === 0) || _vm.isSmallMenuOpen)?_c('li',{key:idx},[_c('a',{attrs:{\"aria-checked\":heading.target === _vm.activeHeading ? 'true' : 'false'},domProps:{\"innerHTML\":_vm._s(heading.label)},on:{\"click\":function($event){_vm.isSmallMenuOpen ? _vm.navigateTo(heading.target) : _vm.toggleSmallMenu()}}})]):_vm._e()]})],2)])]):_vm._e(),(!_vm.isSmall && _vm.headings.length > 0)?_c('nav',{staticClass:\"vertical\"},[_c('ul',_vm._l((_vm.headings),function(heading,idx){return _c('li',{key:idx},[_c('a',{attrs:{\"aria-checked\":heading.target === _vm.activeHeading ? 'true' : 'false'},domProps:{\"innerHTML\":_vm._s(heading.label)},on:{\"click\":function($event){return _vm.navigateTo(heading.target)}}})])}),0)]):_vm._e(),_c('article',[_c('div',{directives:[{name:\"scroll\",rawName:\"v-scroll\",value:(_vm.scrollReader),expression:\"scrollReader\"}],domProps:{\"innerHTML\":_vm._s(_vm.text)},on:{\"click\":_vm.textClick}}),(_vm.footnote)?_c('aside',[_c('a',{on:{\"click\":function($event){return _vm.hideFootnote(_vm.footnote[0])}}},[_vm._v(\"✖\")]),_c('text-node',{attrs:{\"section\":_vm.section,\"node\":_vm.footnote[1]}})],1):_vm._e()]),(!_vm.isSmall && _vm.hasNestedDocs)?_c('aside',_vm._l((_vm.annotations),function(ref,idx){\nvar annotationId = ref[0];\nvar annotation = ref[1];\nreturn _c('section',{key:idx},[_c('a',{on:{\"click\":function($event){return _vm.hideAnnotation(annotationId)}}},[_vm._v(\"✖\")]),(annotation)?_c('text-node',{attrs:{\"section\":_vm.section,\"node\":annotation}}):_vm._e()],1)}),0):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isReference)?_c('a',_vm._b({class:'node-' + _vm.node.type,on:{\"click\":_vm.toggleReference}},'a',_vm.nodeAttrs,false),[(_vm.node.text)?_c('span',[_vm._v(_vm._s(_vm.node.text))]):_vm._e(),_vm._l((_vm.node.content),function(child,idx){return [(child.type === 'text' && _vm.marks(child).length > 0)?_c('span',_vm._b({key:idx,class:_vm.marks(child)},'span',_vm.markAttrs(child),false),[_vm._v(_vm._s(child.text))]):(child.type === 'text')?[_vm._v(_vm._s(child.text))]:_c('text-node',{key:idx,attrs:{\"section\":_vm.section,\"node\":child}})]})],2):(_vm.isInline)?_c('span',_vm._b({class:'node-' + _vm.node.type},'span',_vm.nodeAttrs,false),[(_vm.node.text)?_c('span',[_vm._v(_vm._s(_vm.node.text))]):_vm._e(),_vm._l((_vm.node.content),function(child,idx){return [(child.type === 'text' && _vm.marks(child).length > 0)?_c('span',_vm._b({key:idx,class:_vm.marks(child)},'span',_vm.markAttrs(child),false),[_vm._v(_vm._s(child.text))]):(child.type === 'text')?[_vm._v(_vm._s(child.text))]:_c('text-node',{key:idx,attrs:{\"section\":_vm.section,\"node\":child}})]})],2):_c('div',_vm._b({class:'node-' + _vm.node.type},'div',_vm.nodeAttrs,false),[_vm._l((_vm.node.content),function(child,idx){return [(child.type === 'text' && _vm.marks(child).length > 0)?_c('span',_vm._b({key:idx,class:_vm.marks(child)},'span',_vm.markAttrs(child),false),[_vm._v(_vm._s(child.text))]):(child.type === 'text')?[_vm._v(_vm._s(child.text))]:_c('text-node',{key:idx,attrs:{\"section\":_vm.section,\"node\":child}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport { StringKeyValueDict, SerialisedNode } from '@/interfaces';\n\n@Component({\n    name: 'text-node',\n})\nexport default class TextNode extends Vue {\n    @Prop() section!: string;\n    @Prop() node!: SerialisedNode;\n\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get typeDef() {\n        const schema = this.$store.state.sections[this.$props.section].schema;\n        for(let idx = 0; idx < schema.length; idx++) {\n            if (schema[idx].name === this.$props.node.type) {\n                return schema[idx];\n            }\n        }\n        return null;\n    }\n\n    public get nodeAttrs() {\n        const attrs = {} as StringKeyValueDict;\n        if (this.$props.node.attrs) {\n            Object.entries(this.$props.node.attrs).forEach(([key, value]) => {\n                if (value) {\n                    attrs['data-' + key] = value as string;\n                }\n            });\n        }\n        return attrs;\n    }\n\n    public get isReference() {\n        const type = this.typeDef;\n        if (type && type.reference) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    public get isInline() {\n        const type = this.typeDef;\n        if (type && type.type === 'inline') {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    public marks(node: SerialisedNode) {\n        if (node.marks) {\n            return node.marks.map((mark) => { return 'mark-' + mark.type; });\n        }\n        return [];\n    }\n\n    public markAttrs(node: SerialisedNode) {\n        if (node.marks) {\n            const attrs = {} as StringKeyValueDict;\n            node.marks.forEach((mark) => {\n                if (mark.attrs) {\n                    Object.entries(mark.attrs).forEach(([key, value]) => {\n                        if (value) {\n                            attrs['data-' + key] = value as string;\n                        }\n                    });\n                }\n            });\n            return attrs;\n        }\n        return {};\n    }\n\n    public toggleReference() {\n        const type = this.typeDef;\n        if (type && this.isReference && this.$props.node.attrs[type.reference.attr]) {\n            if (!this.isSmall && type.reference.display === 'sidebar') {\n                this.$store.commit('toggleAnnotation', {\n                    path: this.$props.section + '.nested.' + type.reference.type + '.' + this.$props.node.attrs[type.reference.attr].substring(1),\n                });\n            } else {\n                this.$store.commit('toggleFootnote', {\n                    path: this.$props.section + '.nested.' + type.reference.type + '.' + this.$props.node.attrs[type.reference.attr].substring(1),\n                });\n            }\n        }\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextNode.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextNode.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TextNode.vue?vue&type=template&id=d1c17f70&\"\nimport script from \"./TextNode.vue?vue&type=script&lang=ts&\"\nexport * from \"./TextNode.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// eslint-disable-next-line\nexport default function get(obj: any, path: string) {\n    let pathElements = path.split('.');\n    while (obj && pathElements.length > 0) {\n        if (pathElements[0][0] === '[' && pathElements[0][pathElements[0].length - 1] === ']') {\n            const idx = Number.parseInt(pathElements[0].substring(1, pathElements[0].length - 1));\n            if (idx >= 0 && idx < obj.length) {\n                obj = obj[idx];\n            }\n        } else {\n            obj = obj[pathElements[0]];\n        }\n        pathElements = pathElements.slice(1);\n    }\n    return obj;\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport TextNode from './TextNode.vue';\nimport get from '@/util/get';\nimport { StringKeyValueDict, NumberKeyValueDict, SerialisedNode, AnyKeyValueDict } from '@/interfaces';\n// eslint-disable-next-line\n// @ts-ignore\nimport { tween } from 'femtotween';\n\n@Component({\n    components: {\n        TextNode,\n    },\n})\nexport default class TextReader extends Vue {\n    @Prop() section!: string;\n\n    activeHeading: string | null = '';\n\n    // ===================\n    // Computed properties\n    // ===================\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get doc() {\n        const sectionData = this.$store.state.content[this.$props.section];\n        if (sectionData && sectionData.doc) {\n            return sectionData.doc;\n        } else {\n            return null;\n        }\n    }\n\n    public get hasNestedDocs() {\n        if (this.$store.state.content[this.$props.section].nested) {\n            if (Object.keys(this.$store.state.content[this.$props.section].nested).length > 0) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    public get annotations() {\n        return this.$store.state.ui.sections[this.$props.section].annotations.map((annotation: string) => {\n            const annotationDoc = get(this.$store.state.content, annotation);\n            if (annotationDoc) {\n                return [annotation, annotationDoc.content[0]];\n            } else {\n                return null;\n            }\n        });\n    }\n\n    public get footnote() {\n        const footnote = this.$store.state.ui.sections[this.$props.section].footnote;\n        if (footnote) {\n            const footnoteDoc = get(this.$store.state.content, footnote);\n            if (footnoteDoc) {\n                return [footnote, footnoteDoc.content[0]];\n            }\n        }\n        return null;\n    }\n\n    public get headings() {\n        if (this.doc) {\n            const schema = this.$store.state.sections[this.$props.section].schema;\n            const headings = [] as StringKeyValueDict[];\n            this.generateHeadings(this.doc, schema, headings)\n            return headings;\n        }\n        return [];\n    }\n\n    public get schema() {\n        return this.$store.state.sections[this.$props.section].schema;\n    }\n\n    public get text() {\n        return this.generateHTML(this.doc, this.schema).join('');\n    }\n\n    // ==================\n    // Lifecycle handlers\n    // ==================\n\n    public mounted() {\n        this.docUpdated();\n    }\n\n    // ==============\n    // Event handlers\n    // ==============\n\n    public hideAnnotation(annotation: string) {\n        this.$store.commit('toggleAnnotation', { path: annotation });\n    }\n\n    public hideFootnote(annotation: string) {\n        this.$store.commit('toggleFootnote', { path: annotation });\n    }\n\n    public navigateTo(heading: string) {\n        const element = document.querySelector('[data-id=\"' + heading + '\"]') as HTMLElement;\n        if (element) {\n            const container = this.$el.querySelector('article > div') as HTMLElement;\n            if (container) {\n                tween(container.scrollTop, element.offsetTop, (value: number) => { container.scrollTop = value; });\n            }\n        }\n        if (this.isSmallMenuOpen) {\n            this.toggleSmallMenu();\n        }\n    }\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n\n    public scrollReader(ev: UIEvent, scroll: NumberKeyValueDict) {\n        if (this && this.$el) {\n            const headingsSelector = this.headings.map((heading: StringKeyValueDict) => { return '[data-id=\"' + heading.target + '\"]' }).join(', ');\n            if (headingsSelector !== '') {\n                // Store scroll\n                const teiReaderSrc = window.localStorage.getItem('tei-reader');\n                let teiReader = {} as AnyKeyValueDict;\n                if (teiReaderSrc) {\n                    teiReader = JSON.parse(teiReaderSrc);\n                }\n                if (!teiReader[this.$store.state.ui.identifier]) {\n                    teiReader[this.$store.state.ui.identifier] = {};\n                }\n                if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                    teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n                }\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = scroll.scrollTop;\n                window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n                // Update Headings\n                const headings = this.$el.querySelectorAll(headingsSelector);\n                if (headings.length > 0) {\n                    this.activeHeading = null;\n                    if (scroll.scrollTop > 0) {\n                        const article = this.$el.querySelector('article');\n                        if (article) {\n                            scroll.scrollTop = scroll.scrollTop + article.clientHeight * 0.25;\n                        }\n                    }\n                    for (let idx = 0; idx < headings.length; idx++) {\n                        const heading = headings[idx] as HTMLElement;\n                        if (idx < headings.length - 1) {\n                            const nextHeading = headings[idx + 1] as HTMLElement;\n                            if (scroll.scrollTop >= heading.offsetTop && scroll.scrollTop < nextHeading.offsetTop) {\n                                this.activeHeading = heading.getAttribute('data-id');\n                            }\n                        } else {\n                            if (scroll.scrollTop >= heading.offsetTop) {\n                                this.activeHeading = heading.getAttribute('data-id');\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    public textClick(ev: MouseEvent) {\n        let target = ev.target as HTMLElement;\n        while (target) {\n            if (target.localName === 'a') {\n                break;\n            }\n            target = target.parentElement as HTMLElement;\n        }\n        if (target && target.getAttribute('data-reference-path')) {\n            if (target.getAttribute('data-reference-mode') === 'sidebar') {\n                if (this.$store.state.ui.mode === 'small') {\n                    this.$store.commit('toggleFootnote', { path: target.getAttribute('data-reference-path') });\n                } else {\n                    this.$store.commit('toggleAnnotation', { path: target.getAttribute('data-reference-path') });\n                }\n            } else if (target.getAttribute('data-reference-mode') === 'footnote') {\n                this.$store.commit('toggleFootnote', { path: target.getAttribute('data-reference-path') });\n            }\n        }\n    }\n\n    // =======\n    // Watches\n    // =======\n\n    @Watch('doc')\n    public docUpdated() {\n        const container = this.$el.querySelector('article > div') as HTMLElement;\n        container.scrollTop = 0;\n        if (window.localStorage && this.$store.state.ui.identifier && this.$props.section) {\n            const teiReaderSrc = window.localStorage.getItem('tei-reader');\n            let teiReader = {} as AnyKeyValueDict;\n            if (teiReaderSrc) {\n                teiReader = JSON.parse(teiReaderSrc);\n            }\n            if (!teiReader[this.$store.state.ui.identifier]) {\n                teiReader[this.$store.state.ui.identifier] = {};\n            }\n            if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n            }\n            const container = this.$el.querySelector('article > div') as HTMLElement;\n            Vue.nextTick(() => {\n                container.scrollTop = teiReader[this.$store.state.ui.identifier][this.$props.section];\n            });\n            window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n        }\n    }\n\n    // ===============\n    // Private methods\n    // ===============\n\n    private nodeSchema(name: string, schema: any) {\n        for (let idx = 0; idx < schema.length; idx++) {\n            if (schema[idx].name === name) {\n                return schema[idx];\n            }\n        }\n        return null;\n    }\n\n    private getText(node: SerialisedNode): string {\n        if (node.type === 'text' && node.text) {\n            return node.text;\n        } else {\n            if (node.content) {\n                return node.content.map((child) => { return this.getText(child); }).join('');\n            } else {\n                return '';\n            }\n        }\n    }\n\n    private generateHeadings(node: SerialisedNode, schema: any, headings: StringKeyValueDict[]) {\n        if (node) {\n            for (let idx = 0; idx < schema.length; idx++) {\n                if (schema[idx].name === node.type && schema[idx].navigation && node.attrs && node.attrs[schema[idx].navigation.attr]) {\n                    headings.push({\n                        target: node.attrs[schema[idx].navigation.attr] as string,\n                        label: this.getText(node),\n                    });\n                }\n            }\n            if (node.content) {\n                for (let idx = 0; idx < node.content.length; idx++) {\n                    this.generateHeadings(node.content[idx], schema, headings)\n                }\n            }\n        }\n    }\n\n    private generateHTML(node: SerialisedNode, schema: any) {\n        let textElements = [] as string[];\n        if (node) {\n            const nodeSchema = this.nodeSchema(node.type, schema);\n            if (nodeSchema) {\n                if (nodeSchema.name === 'text') {\n                    if (node.marks) {\n                        textElements.push('<span class=\"');\n                        node.marks.forEach((mark, idx) => {\n                            if (idx > 0) {\n                                textElements.push(' mark-' + mark.type);\n                            } else {\n                                textElements.push('mark-' + mark.type);\n                            }\n                        });\n                        textElements.push('\"');\n                        node.marks.forEach((mark) => {\n                            if (mark.attrs) {\n                                Object.entries(mark.attrs).forEach(([key, value]) => {\n                                    textElements.push(' data-' + key + '=\"' + value + '\"');\n                                });\n                            }\n                        });\n                        textElements.push('>');\n                    }\n                } else if (nodeSchema.reference) {\n                    textElements.push('<a class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    if (node.attrs && nodeSchema.reference && nodeSchema.reference.attr && node.attrs[nodeSchema.reference.attr]) {\n                        textElements.push(' data-reference-path=\"' + this.$props.section + '.nested.' + nodeSchema.reference.type + '.' + (node.attrs[nodeSchema.reference.attr] as string).substring(1) + '\"');\n                        textElements.push(' data-reference-mode=\"' + nodeSchema.reference.display + '\"');\n                    }\n                    textElements.push('>');\n                } else if (nodeSchema.type === 'inline') {\n                    textElements.push('<span class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    textElements.push('>');\n                } else {\n                    textElements.push('<div class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    textElements.push('>');\n                }\n                if (node.text) {\n                    textElements.push(node.text);\n                }\n                if (node.content) {\n                    for (let idx = 0; idx < node.content.length; idx++) {\n                        const tmpElements = this.generateHTML(node.content[idx], schema);\n                        textElements = textElements.concat(tmpElements);\n                    }\n                }\n                if (nodeSchema.name === 'text') {\n                    if (node.marks) {\n                        textElements.push('</span>');\n                    }\n                } else if (nodeSchema.reference) {\n                    textElements.push('</a>');\n                } else if (nodeSchema.type === 'inline') {\n                    textElements.push('</span>');\n                } else {\n                    textElements.push('</div>');\n                }\n            } else if (node.type === 'doc') {\n                if (node.content) {\n                    for (let idx = 0; idx < node.content.length; idx++) {\n                        const tmpElements = this.generateHTML(node.content[idx], schema);\n                        textElements = textElements.concat(tmpElements);\n                    }\n                }\n            }\n        }\n        return textElements;\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TextReader.vue?vue&type=template&id=69c82e10&\"\nimport script from \"./TextReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./TextReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{staticClass:\"metadata-reader\"},[(_vm.isSmall && !_vm.isSmallMenuOpen)?_c('div',{class:_vm.isSmallMenuOpen ? 'small-menu-open' : null},[_c('nav',[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]),_c('nav',{staticClass:\"vertical\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(_vm._s(_vm.$store.state.sections[_vm.section].label))])])])])]):_vm._e(),_vm._l((_vm.metadataGroups),function(group,idx){return _c('section',{key:idx},[_c('h2',[_vm._v(_vm._s(group.label))]),_vm._l((group.entries),function(entry,idx2){return _c('metadata-field',{key:idx2,attrs:{\"section\":_vm.section,\"config\":entry,\"parent\":''}})})],2)})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.config.type == 'single-text')?[_c('span',{staticClass:\"field\"},[_c('span',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.config.label))]),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.value))])])]:_vm._e(),(_vm.config.type == 'multi-row')?[_c('ol',{staticClass:\"multi-row\"},_vm._l((_vm.value),function(data,idx){return _c('li',{key:idx},_vm._l((_vm.config.entries),function(entry,idx2){return _c('metadata-field',{key:idx2,attrs:{\"section\":_vm.section,\"config\":entry,\"parent\":_vm.parent + _vm.config.path + '.[' + idx + ']'}})}),1)}),0)]:_vm._e(),(_vm.config.type == 'multi-field')?[_c('ol',{staticClass:\"multi-field\"},_vm._l((_vm.config.entries),function(entry,idx){return _c('li',{key:idx},[_c('metadata-field',{attrs:{\"section\":_vm.section,\"config\":entry,\"parent\":_vm.parent + _vm.config.path}})],1)}),0)]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport get from '@/util/get';\nimport { ConfigMetadataNodeSchema } from '@/interfaces';\n\n@Component({\n    name: 'metadata-field',\n})\nexport default class MetadataField extends Vue {\n    @Prop() config!: ConfigMetadataNodeSchema;\n    @Prop() section!: string;\n    @Prop() parent!: string;\n\n    public get value() {\n        const value = get(this.$store.state.content[this.$props.section], this.$props.parent + this.$props.config.path);\n        if (value) {\n            return value;\n        } else {\n            return '';\n        }\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataField.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataField.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MetadataField.vue?vue&type=template&id=05127f29&\"\nimport script from \"./MetadataField.vue?vue&type=script&lang=ts&\"\nexport * from \"./MetadataField.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport MetadataField from './MetadataField.vue';\n\n@Component({\n    components: {\n        MetadataField,\n    },\n})\nexport default class MetadataReader extends Vue {\n    @Prop() section!: string;\n\n    // ===================\n    // Computed properties\n    // ===================\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get metadataGroups() {\n        return this.$store.state.sections[this.$props.section].ui;\n    }\n\n    // ==============\n    // Event handlers\n    // ==============\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MetadataReader.vue?vue&type=template&id=63c695fe&\"\nimport script from \"./MetadataReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./MetadataReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{staticClass:\"nested-list-reader\"},[(_vm.isSmall && !_vm.isSmallMenuOpen)?_c('div',{class:_vm.isSmallMenuOpen ? 'small-menu-open' : null},[_c('nav',[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]),_c('nav',{staticClass:\"vertical\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(_vm._s(_vm.$store.state.sections[_vm.section].label))])])])])]):_vm._e(),_c('article',[_c('div',{directives:[{name:\"scroll\",rawName:\"v-scroll\",value:(_vm.scrollReader),expression:\"scrollReader\"}],domProps:{\"innerHTML\":_vm._s(_vm.text)},on:{\"click\":_vm.textClick}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport TextNode from './TextNode.vue';\nimport { NumberKeyValueDict, SerialisedNode, AnyKeyValueDict } from '@/interfaces';\n// eslint-disable-next-line\n// @ts-ignore\nimport { tween } from 'femtotween';\n\n@Component({\n    components: {\n        TextNode,\n    },\n})\nexport default class NestedListReader extends Vue {\n    @Prop() section!: string;\n\n    activeHeading: string | null = '';\n\n    // ===================\n    // Computed properties\n    // ===================\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get sectionData() {\n        return this.$store.state.sections[this.$props.section];\n    }\n\n    public get docs(): {[x: string]: SerialisedNode} | null {\n        const sectionData = this.$store.state.content[this.sectionData.source];\n        if (sectionData && sectionData.nested && sectionData.nested[this.sectionData.nodeName]) {\n            return sectionData.nested[this.sectionData.nodeName];\n        } else {\n            return null;\n        }\n    }\n\n    public get schema() {\n        return this.$store.state.sections[this.sectionData.source].schema;\n    }\n\n    public get text() {\n        if (this.docs) {\n            let lines = ['<ol>'];\n            Object.entries(this.docs).forEach(([id, node]) => {\n                if (node.content && node.content.length > 0) {\n                    lines.push('<li id=\"' + id + '\">');\n                    lines = lines.concat(this.generateHTML(node.content[0], this.schema));\n                    lines.push('</li>');\n                }\n            });\n            lines.push('</ol>');\n            return lines.join('');\n            //return this.generateHTML(this.doc, this.schema).join('');\n        } else {\n            return null;\n        }\n    }\n\n    // ==================\n    // Lifecycle handlers\n    // ==================\n\n    public mounted() {\n        this.docUpdated();\n    }\n\n    // ==============\n    // Event handlers\n    // ==============\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n\n    public scrollReader(ev: UIEvent, scroll: NumberKeyValueDict) {\n        if (this && this.$el) {\n            const teiReaderSrc = window.localStorage.getItem('tei-reader');\n            let teiReader = {} as AnyKeyValueDict;\n            if (teiReaderSrc) {\n                teiReader = JSON.parse(teiReaderSrc);\n            }\n            if (!teiReader[this.$store.state.ui.identifier]) {\n                teiReader[this.$store.state.ui.identifier] = {};\n            }\n            if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n            }\n            teiReader[this.$store.state.ui.identifier][this.$props.section] = scroll.scrollTop;\n            window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n        }\n    }\n\n    public textClick(ev: MouseEvent) {\n        let target = ev.target as HTMLElement;\n        while (target) {\n            if (target.localName === 'a') {\n                break;\n            }\n            target = target.parentElement as HTMLElement;\n        }\n        const referencePath = target.getAttribute('data-reference-path');\n        if (target && referencePath) {\n            const path = referencePath.split('.');\n            if (path.length > 0 && path[0] === this.sectionData.source && path[2] == this.sectionData.nodeName) {\n                const container = this.$el.querySelector('article > div') as HTMLElement;\n                const element = this.$el.querySelector('#' + path[3]) as HTMLElement;\n                if (container && element) {\n                    tween(container.scrollTop, element.offsetTop, (value: number) => { container.scrollTop = value; });\n                }\n            }\n        }\n    }\n\n    // =======\n    // Watches\n    // =======\n\n    @Watch('doc')\n    public docUpdated() {\n        const container = this.$el.querySelector('article > div') as HTMLElement;\n        container.scrollTop = 0;\n        if (window.localStorage && this.$store.state.ui.identifier && this.$props.section) {\n            const teiReaderSrc = window.localStorage.getItem('tei-reader');\n            let teiReader = {} as AnyKeyValueDict;\n            if (teiReaderSrc) {\n                teiReader = JSON.parse(teiReaderSrc);\n            }\n            if (!teiReader[this.$store.state.ui.identifier]) {\n                teiReader[this.$store.state.ui.identifier] = {};\n            }\n            if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n            }\n            const container = this.$el.querySelector('article > div') as HTMLElement;\n            Vue.nextTick(() => {\n                container.scrollTop = teiReader[this.$store.state.ui.identifier][this.$props.section];\n            });\n            window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n        }\n    }\n\n    // ===============\n    // Private methods\n    // ===============\n\n    private nodeSchema(name: string, schema: any) {\n        for (let idx = 0; idx < schema.length; idx++) {\n            if (schema[idx].name === name) {\n                return schema[idx];\n            }\n        }\n        return null;\n    }\n\n    private getText(node: SerialisedNode): string {\n        if (node.type === 'text' && node.text) {\n            return node.text;\n        } else {\n            if (node.content) {\n                return node.content.map((child) => { return this.getText(child); }).join('');\n            } else {\n                return '';\n            }\n        }\n    }\n\n    private generateHTML(node: SerialisedNode, schema: any) {\n        let textElements = [] as string[];\n        if (node) {\n            const nodeSchema = this.nodeSchema(node.type, schema);\n            if (nodeSchema) {\n                if (nodeSchema.name === 'text') {\n                    if (node.marks) {\n                        textElements.push('<span class=\"');\n                        node.marks.forEach((mark, idx) => {\n                            if (idx > 0) {\n                                textElements.push(' mark-' + mark.type);\n                            } else {\n                                textElements.push('mark-' + mark.type);\n                            }\n                        });\n                        textElements.push('\"');\n                        node.marks.forEach((mark) => {\n                            if (mark.attrs) {\n                                Object.entries(mark.attrs).forEach(([key, value]) => {\n                                    textElements.push(' data-' + key + '=\"' + value + '\"');\n                                });\n                            }\n                        });\n                        textElements.push('>');\n                    }\n                } else if (nodeSchema.reference) {\n                    textElements.push('<a class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    if (node.attrs && nodeSchema.reference && nodeSchema.reference.attr && node.attrs[nodeSchema.reference.attr]) {\n                        textElements.push(' data-reference-path=\"' + this.$props.section + '.nested.' + nodeSchema.reference.type + '.' + (node.attrs[nodeSchema.reference.attr] as string).substring(1) + '\"');\n                        textElements.push(' data-reference-mode=\"' + nodeSchema.reference.display + '\"');\n                    }\n                    textElements.push('>');\n                } else if (nodeSchema.type === 'inline') {\n                    textElements.push('<span class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    textElements.push('>');\n                } else {\n                    textElements.push('<div class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    textElements.push('>');\n                }\n                if (node.text) {\n                    textElements.push(node.text);\n                }\n                if (node.content) {\n                    for (let idx = 0; idx < node.content.length; idx++) {\n                        const tmpElements = this.generateHTML(node.content[idx], schema);\n                        textElements = textElements.concat(tmpElements);\n                    }\n                }\n                if (nodeSchema.name === 'text') {\n                    if (node.marks) {\n                        textElements.push('</span>');\n                    }\n                } else if (nodeSchema.reference) {\n                    textElements.push('</a>');\n                } else if (nodeSchema.type === 'inline') {\n                    textElements.push('</span>');\n                } else {\n                    textElements.push('</div>');\n                }\n            } else if (node.type === 'doc') {\n                if (node.content) {\n                    for (let idx = 0; idx < node.content.length; idx++) {\n                        const tmpElements = this.generateHTML(node.content[idx], schema);\n                        textElements = textElements.concat(tmpElements);\n                    }\n                }\n            }\n        }\n        return textElements;\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NestedListReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NestedListReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./NestedListReader.vue?vue&type=template&id=50ff2e2f&\"\nimport script from \"./NestedListReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./NestedListReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport TextReader from './TextReader.vue';\nimport MetadataReader from './MetadataReader.vue';\nimport NestedListReader from './NestedListReader.vue';\n\n@Component({\n    components: {\n        TextReader,\n        MetadataReader,\n        NestedListReader,\n    },\n})\nexport default class TeiReader extends Vue {\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get hasMultipleSections() {\n        return Object.keys(this.$store.state.sections).length > 1;\n    }\n\n    public get sections() {\n        return this.$store.state.sections;\n    }\n\n    public get selectedSection() {\n        return this.$store.state.ui.selectedSection;\n    }\n\n\n    public get closeLabel() {\n        return this.$store.state.ui.closeLabel;\n    }\n\n    public get closeCallback() {\n        return this.$store.state.callbacks.close;\n    }\n\n    public selectSection(key: string) {\n        this.$store.commit('selectSection', key);\n        if (this.isSmall) {\n            this.$store.commit('toggleSmallMenu');\n        }\n    }\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n\n    public close() {\n        if (this.isSmall) {\n            this.$store.commit('toggleSmallMenu');\n        }\n        this.closeCallback();\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TeiReader.vue?vue&type=template&id=233dce41&\"\nimport script from \"./TeiReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./TeiReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport TeiReader from './components/TeiReader.vue';\n\n@Component({\n  components: {\n    TeiReader,\n  },\n})\nexport default class App extends Vue {\n    public mounted() {\n        const configElement = document.getElementById('TEIReaderConfig');\n        if (configElement) {\n            const config = JSON.parse(configElement.innerHTML);\n            if (config) {\n                this.$store.commit('init', config);\n            }\n        }\n        if (this.$store.state.callbacks && this.$store.state.callbacks.autoLoad) {\n            this.$store.state.callbacks.autoLoad((sourceData: string) => {\n                this.$store.dispatch('load', sourceData);\n            });\n        }\n        this.updateWindowSize();\n        window.addEventListener('resize', this.updateWindowSize);\n    }\n\n    public beforeDestroy() {\n        window.removeEventListener('resize', this.updateWindowSize);\n    }\n\n    public updateWindowSize() {\n        if (window.innerWidth < 1024) {\n            this.$store.commit('setMode', 'small');\n        } else {\n            this.$store.commit('setMode', 'large');\n        }\n    }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=f747fe56&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","function nsResolver(prefix: string | null) {\n    if (prefix === 'tei') {\n        return 'http://www.tei-c.org/ns/1.0';\n    } else if (prefix === 'xml') {\n        return 'http://www.w3.org/XML/1998/namespace';\n    } else {\n        return 'http://www.tei-c.org/ns/1.0';\n    }\n}\n\nexport default class XPathEvaluator {\n    private dom: XMLDocument;\n\n    constructor (dom: XMLDocument) {\n        this.dom = dom;\n    }\n\n    evaluate(node: Node, xpath: string, resultType: number) {\n        return this.dom.evaluate(xpath, node, nsResolver, resultType, null);\n    }\n\n    firstNode(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue;\n    }\n\n    nodeIterator(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.ORDERED_NODE_ITERATOR_TYPE);\n    }\n\n    stringValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.STRING_TYPE).stringValue;\n    }\n\n    booleanValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.BOOLEAN_TYPE).booleanValue;\n    }\n\n    numberValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.NUMBER_TYPE).numberValue;\n    }\n}\n","import XPathEvaluator from './XPathEvaluator';\nimport get from './get';\n\nexport default class TEIMetadataParser {\n    private dom: XMLDocument;\n    private xpath: XPathEvaluator;\n    private config: any;\n    private data: any;\n\n    constructor(dom: XMLDocument, config: any) {\n        this.dom = dom;\n        this.xpath = new XPathEvaluator(this.dom);\n        this.config = config;\n    }\n\n    public get() {\n        if (!this.data) {\n            const header = this.xpath.firstNode(this.dom.documentElement, '/tei:TEI/tei:teiHeader') as Element;\n            this.data = {};\n            for (let idx = 0; idx < this.config.schema.length; idx++) {\n                const temp = this.parseHeaderNode(header, this.config.schema[idx]);\n                if (temp) {\n                    this.data[this.config.schema[idx].tag.substring(4)] = temp;\n                }\n            }\n        }\n        return this.data;\n    }\n\n    private parseHeaderNode(node: Element, schema: any) {\n        const elements = this.xpath.nodeIterator(node, schema.tag);\n        const result = [] as any;\n        let element = elements.iterateNext() as Element;\n        while (element) {\n            const obj = {\n                _attrs: {},\n                _text: element.children.length === 0 ? this.xpath.stringValue(element, 'text()') : null\n            } as any;\n            for(let idx = 0; idx < element.attributes.length; idx++) {\n                obj._attrs[element.attributes[idx].name] = element.attributes[idx].value;\n            }\n            if (schema.children) {\n                for (let idx = 0; idx < schema.children.length; idx++) {\n                    const temp = this.parseHeaderNode(element, schema.children[idx]);\n                    if (temp) {\n                        obj[schema.children[idx].tag.substring(schema.children[idx].tag.indexOf(':') + 1)] = temp;\n                    }\n                }\n            }\n            result.push(obj);\n            element = elements.iterateNext() as Element;\n        }\n        if (result.length === 0) {\n            return null;\n        } else {\n            if (schema.multiple) {\n                return result;\n            } else {\n                return result[0];\n            }\n        }\n    }\n}\n","import XPathEvaluator from './XPathEvaluator';\nimport { SerialisedNode, NestedDocSet, SerialisedAttrs, ParseAttributesSchema, ParseParserSchema, TEITextParserConfig,\n    ParseNodeSchema, SerialisedNodeMark } from '@/interfaces';\n\nexport default class TEITextParser {\n    private dom: XMLDocument;\n    private xpath: XPathEvaluator;\n    private config: TEITextParserConfig;\n    private doc: SerialisedNode | null = null;\n    private nestedDocs: NestedDocSet = {} as NestedDocSet;\n\n    constructor(dom: XMLDocument, config: TEITextParserConfig) {\n        this.dom = dom;\n        this.xpath = new XPathEvaluator(this.dom);\n        this.config = config;\n    }\n\n    public get(): [SerialisedNode, NestedDocSet] {\n        if (!this.doc) {\n            this.doc = {\n                type: 'doc',\n                content: [],\n            };\n            this.nestedDocs = {};\n            if (this.config.parser && this.config.parser.selector) {\n                const node = this.xpath.firstNode(this.dom.documentElement, this.config.parser.selector) as Element;\n                if (node) {\n                    for(let idx = 0; idx < node.children.length; idx++) {\n                        const tmp = this.parseContentNode(node.children[idx], this.config);\n                        if (tmp && !tmp.nestedDoc && this.doc.content) {\n                            this.doc.content.push(tmp);\n                        } else if (tmp && tmp.nestedDoc) {\n                            this.addNestedDoc(tmp);\n                        }\n                    }\n                }\n            }\n        }\n        return [this.doc, this.nestedDocs];\n    }\n\n    private parseContentAttributes(node: Element, attrs: ParseAttributesSchema) {\n        // Parse attributes for nodes or marks. Attributes can have a type which is boolean, number, static, or string (default).\n        const result = {} as SerialisedAttrs;\n        Object.entries(attrs).forEach(([key, schema]) => {\n            let parsers = [] as ParseParserSchema[];\n            if (schema.parser) {\n                parsers.push(schema.parser);\n            } else if (schema.parsers) {\n                parsers = schema.parsers;\n            }\n            for (let idx = 0; idx < parsers.length; idx++) {\n                const parser = parsers[idx];\n                if (parser.type === 'boolean') {\n                    result[key] = this.xpath.booleanValue(node, parser.selector);\n                } else if (parser.type === 'number') {\n                    try {\n                        result[key] = this.xpath.numberValue(node, parser.selector);\n                    } catch(e) {\n                        // eslint-disable-next-line\n                        console.log(e);\n                    }\n                } else if (parser.type === 'static') {\n                    if (this.xpath.booleanValue(node, parser.selector)) {\n                        result[key] = parser.value;\n                    }\n                } else {\n                    try {\n                        const value = this.xpath.stringValue(node, parser.selector);\n                        if (value) {\n                            result[key] = value;\n                        }\n                    } catch(e) {\n                        // eslint-disable-next-line\n                        console.log(e);\n                    }\n                }\n            }\n        });\n        return result;\n    }\n\n    private parseContentMarks(node: Element, schema: ParseNodeSchema[]) {\n        // Parse the marks of a text node\n        const result = [] as SerialisedNodeMark[];\n        schema.forEach((entry: ParseNodeSchema) => {\n            if (entry.type === 'mark') {\n                let parsers = [] as ParseParserSchema[];\n                if (entry.parser) {\n                    parsers.push(entry.parser);\n                } else if (entry.parsers) {\n                    parsers = entry.parsers;\n                }\n                for (let idx = 0; idx < parsers.length; idx++) {\n                    if (this.xpath.booleanValue(node, parsers[idx].selector)) {\n                        const mark = {\n                            type: entry.name\n                        } as SerialisedNodeMark;\n                        if (entry.attrs) {\n                            mark.attrs = this.parseContentAttributes(node, entry.attrs);\n                        }\n                        result.push(mark);\n                    }\n                }\n            }\n        });\n        return result;\n    }\n\n    private parseContentNode(node: Element, section: TEITextParserConfig) {\n        // Parse a single content node\n        const entries = Object.entries(section.schema);\n        for (let idx = 0; idx < entries.length; idx++) {\n            //let key = entries[idx][0];\n            const nodeSchema = entries[idx][1] as ParseNodeSchema;\n            let parsers = [] as ParseParserSchema[];\n            if (nodeSchema.parser) {\n                parsers.push(nodeSchema.parser);\n            } else if (nodeSchema.parsers) {\n                parsers = parsers.concat(nodeSchema.parsers);\n            }\n            for (let idx2 = 0; idx2 < parsers.length; idx2++) {\n                const parser = parsers[idx2];\n                if (this.xpath.firstNode(node, 'self::' + parser.selector) !== null) {\n                    // The first schema node where the parser selector matches is chosen as the result\n                    const result = {\n                        type: nodeSchema.name\n                    } as SerialisedNode;\n                    if (nodeSchema.attrs) {\n                        result.attrs = this.parseContentAttributes(node, nodeSchema.attrs);\n                    }\n                    if (nodeSchema.type === 'nested') {\n                        result.nestedDoc = true;\n                    }\n                    if (nodeSchema.type === 'inline') {\n                        // Inline nodes are either loaded as text nodes with marks or as complex text nodes\n                        if (nodeSchema.name === 'text') {\n                            if (parser.text) {\n                                result.text = this.xpath.stringValue(node, parser.text);\n                            }\n                            result.marks = this.parseContentMarks(node, section.schema);\n                            if (node.children.length === 1) {\n                                const temp = this.parseContentNode(node.children[0], section);\n                                if (temp && temp.text && temp.text !== '') {\n                                    result.text = temp.text;\n                                }\n                                if (temp && temp.marks) {\n                                    result.marks = result.marks.concat(temp.marks);\n                                }\n                            }\n                        } else {\n                            if (node.children.length === 0) {\n                                // Inline nodes without children need a virtual text node added if they have text\n                                if (parser.text && this.xpath.stringValue(node, parser.text)) {\n                                    result.content = [\n                                        {\n                                            type: 'text',\n                                            text: this.xpath.stringValue(node, parser.text),\n                                            marks: this.parseContentMarks(node, section.schema)\n                                        }\n                                    ];\n                                }\n                            } else {\n                                const content = [];\n                                for (let idx3 = 0; idx3 < node.children.length; idx3++) {\n                                    const child = this.parseContentNode(node.children[idx3], section);\n                                    if (child) {\n                                        content.push(child);\n                                    }\n                                }\n                                result.content = content;\n                            }\n                        }\n                    } else {\n                        const content = [];\n                        for (let idx3 = 0; idx3 < node.children.length; idx3++) {\n                            const child = this.parseContentNode(node.children[idx3], section);\n                            if (child && !child.nestedDoc) {\n                                content.push(child);\n                            } else if (child && child.nestedDoc) {\n                                this.addNestedDoc(child);\n                            }\n                        }\n                        result.content = content;\n                    }\n                    return result;\n                }\n            }\n        }\n        return null;\n    }\n\n    private addNestedDoc(nestedParent: SerialisedNode) {\n        if (nestedParent.attrs && nestedParent.attrs.id) {\n            if (!this.nestedDocs[nestedParent.type]) {\n                this.nestedDocs[nestedParent.type] = {};\n            }\n            this.nestedDocs[nestedParent.type][nestedParent.attrs.id] = nestedParent;\n            const nestedDoc = {\n                type: 'doc',\n                content: nestedParent.content,\n            }\n            nestedParent.content = [nestedDoc];\n        }\n    }\n}\n","/**\n * Performs a deep cloning of the first element of the parameters.\n */\nexport default function deepclone(obj: any): any {\n    if (obj === undefined) {\n        return undefined;\n    } else if (obj === null) {\n        return null;\n    } else if (Array.isArray(obj)) {\n        return obj.map((val) => {\n            return deepclone(val);\n        });\n    } else if (typeof(obj) === 'object') {\n        const clone = {} as any;\n        Object.keys(obj).forEach(function(key) {\n            clone[key] = deepclone(obj[key]);\n        });\n        return clone;\n    } else {\n        return obj;\n    }\n}\n","import Vue from 'vue'\nimport Vuex from 'vuex'\n\nimport TEIMetadataParser from '@/util/TEIMetadataParser';\nimport TEITextParser from '@/util/TEITextParser';\nimport deepclone from '@/util/deepclone';\nimport { State, Config, MutationSetTextDoc, MutationToggleAnnotation, MutationSetMetadata, LoadActionParameters } from '@/interfaces';\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n    state: {\n        content: {\n        },\n        callbacks: {\n        },\n        sections: {\n        },\n        ui: {\n            mode: 'small',\n            smallMenuOpen: false,\n            selectedSection: null,\n            sections: {},\n            closeLabel: null,\n            identifier: '',\n        }\n    } as State,\n    mutations: {\n        init(state, config: Config) {\n            state.sections = config.sections;\n            Object.keys(config.sections).forEach((key, idx) => {\n                Vue.set(state.content, key, {});\n                if (config.sections[key].type === 'Text') {\n                    Vue.set(state.content[key], 'doc', null);\n                    Vue.set(state.content[key], 'nested', {});\n                }\n\n                Vue.set(state.ui.sections, key, {});\n                if (config.sections[key].type === 'Text') {\n                    Vue.set(state.ui.sections[key], 'annotations', []);\n                    Vue.set(state.ui.sections[key], 'footnote', null);\n                }\n\n                if (idx === 0) {\n                    state.ui.selectedSection = key;\n                }\n            });\n            // eslint-disable-next-line\n            // @ts-ignore\n            if (window.TEIReader && window.TEIReader.callbacks) {\n                // eslint-disable-next-line\n                // @ts-ignore\n                Vue.set(state.callbacks, 'autoLoad', window.TEIReader.callbacks.autoLoad);\n                // eslint-disable-next-line\n                // @ts-ignore\n                Vue.set(state.callbacks, 'close', window.TEIReader.callbacks.close);\n            }\n            if (config.ui && config.ui.closeLabel) {\n                state.ui.closeLabel = config.ui.closeLabel;\n            }\n        },\n\n        setTextDoc(state, payload: MutationSetTextDoc) {\n            const path = payload.path.split('.');\n            if (path.length === 2) {\n                Vue.set(state.content[path[0]], path[1], payload.doc);\n            } else if(path.length === 4) {\n                Vue.set(state.content[path[0]].nested[path[2]][path[3]], 'content', [payload.doc]);\n            }\n        },\n\n        addNestedDoc(state, payload: MutationSetTextDoc) {\n            const path = payload.path.split('.');\n            if (path.length === 4) {\n                if (!state.content[path[0]].nested[path[2]]) {\n                    Vue.set(state.content[path[0]].nested, path[2], {});\n                }\n                Vue.set(state.content[path[0]].nested[path[2]], path[3], {\n                    attrs: {\n                        id: path[3],\n                    },\n                    content: [\n                        payload.doc,\n                    ],\n                    nestedDoc: true,\n                    type: path[2],\n                });\n            }\n        },\n\n        setMetadata(state, payload: MutationSetMetadata) {\n            Vue.set(state.content, payload.path, payload.metadata);\n        },\n\n        selectSection(state, section: string) {\n            state.ui.selectedSection = section;\n        },\n\n        toggleAnnotation(state, payload: MutationToggleAnnotation) {\n            const path = payload.path.split('.');\n            if (path.length === 4) {\n                const annotations = deepclone(state.ui.sections[path[0]].annotations);\n                if (annotations.indexOf(payload.path) >= 0) {\n                    annotations.splice(annotations.indexOf(payload.path), 1);\n                } else {\n                    annotations.push(payload.path);\n                }\n                Vue.set(state.ui.sections[path[0]], 'annotations', annotations);\n            }\n        },\n\n        toggleFootnote(state, payload: MutationToggleAnnotation) {\n            const path = payload.path.split('.');\n            if (path.length === 4) {\n                if (state.ui.sections[path[0]].footnote === payload.path) {\n                    Vue.set(state.ui.sections[path[0]], 'footnote', null);\n                } else {\n                    Vue.set(state.ui.sections[path[0]], 'footnote', payload.path);\n                }\n            }\n        },\n\n        toggleSmallMenu(state) {\n            state.ui.smallMenuOpen = !state.ui.smallMenuOpen;\n        },\n\n        setMode(state, payload: string) {\n            state.ui.mode = payload;\n        },\n\n        setDocIdentifier(state, payload: string) {\n            state.ui.identifier = payload;\n        },\n    },\n    actions: {\n        load({ commit, state }, newDoc: LoadActionParameters) {\n            commit('setDocIdentifier', newDoc.identifier);\n            const domParser = new DOMParser();\n            const dom = domParser.parseFromString(newDoc.content, 'application/xml');\n            Vue.set(state, 'content', {});\n            Object.keys(state.sections).forEach((key) => {\n                Vue.set(state.content, key, {});\n                Vue.set(state.content[key], 'doc', null);\n                Vue.set(state.content[key], 'nested', {});\n            });\n            Object.entries(state.sections).forEach(([key, config]) => {\n                if (config.type === 'Metadata') {\n                    commit('setMetadata', { path: key, metadata: (new TEIMetadataParser(dom, config)).get() });\n                } else if (config.type === 'Text') {\n                    const [doc, nestedDocs] = (new TEITextParser(dom, config)).get();\n                    commit('setTextDoc', { path: key + '.doc', doc: doc });\n                    Object.entries(nestedDocs).forEach(([nestedKey, docs]) => {\n                        Object.entries(docs).forEach(([docKey, doc]) => {\n                            if (doc.content) {\n                                commit('addNestedDoc', {path: key + '.nested.' + nestedKey + '.' + docKey, doc: doc.content[0]});\n                            }\n                        });\n                    });\n                }\n            });\n        }\n    },\n    modules: {\n    }\n})\n","import Vue from 'vue';\nimport App from './App.vue';\nimport store from './store';\n// eslint-disable-next-line\n// @ts-ignore\nimport vuescroll from 'vue-scroll';\n\nVue.use(vuescroll, { debounce: 50 });\n\nVue.config.productionTip = false\n\nnew Vue({\n  store,\n  render: h => h(App)\n}).$mount('#app')\n"],"sourceRoot":""}